## 2.1.58

- Remote Controlをより多くのユーザーに拡大

## 2.1.56

- VS Code：「command 'claude-vscode.editor.openLast' not found」クラッシュのもう一つの原因を修正

## 2.1.55

- WindowsでBashToolがEINVALエラーで失敗する問題を修正

## 2.1.53

- ユーザー入力が送信後、メッセージがレンダリングされる前に一瞬消えるUIのちらつきを修正
- 一括エージェント終了（ctrl+f）を改善し、エージェントごとに1つずつではなく単一の集約通知を送信するようにし、コマンドキューを適切にクリアするように修正
- Remote Control使用時に、グレースフルシャットダウンが古いセッションを残すことがある問題を、ネットワーク呼び出しの並列化により修正
- `--worktree`が初回起動時に無視されることがある問題を修正
- Windowsで「switch on corrupted value」というパニックを修正
- Windowsで多数のプロセスを起動する際に発生する可能性があったクラッシュを修正
- Linux x64およびWindows x64のWebAssemblyインタープリタのクラッシュを修正
- Windows ARM64で2分後に発生することがあったクラッシュを修正

## 2.1.52

- VS Code：Windowsでの拡張機能のクラッシュ（「command 'claude-vscode.editor.openLast' not found」）を修正

## 2.1.51

- 外部ビルド向けに`claude remote-control`サブコマンドを追加し、すべてのユーザーがローカル環境を提供できるようになりました。
- プラグインマーケットプレイスのデフォルトgitタイムアウトを30秒から120秒に更新し、`CLAUDE_CODE_PLUGIN_GIT_TIMEOUT_MS`で設定可能にしました。
- npmソースからプラグインをインストールする際のカスタムnpmレジストリと特定バージョンの固定をサポート
- BashToolは、シェルスナップショットが利用可能な場合、デフォルトでログインシェル（`-l`フラグ）をスキップするようになり、コマンド実行のパフォーマンスが向上しました。以前はこれに`CLAUDE_BASH_NO_LOGIN=true`の設定が必要でした。
- インタラクティブモードで`statusLine`および`fileSuggestion`フックコマンドがワークスペース信頼の承認なしに実行される可能性があったセキュリティ問題を修正
- 50K文字を超えるツール結果はディスクに永続化されるようになりました（以前は100K）。これによりコンテキストウィンドウの使用量が削減され、会話の持続性が向上します。
- 重複した`control_response`メッセージ（WebSocket再接続などによる）が、会話に重複したアシスタントメッセージをプッシュすることでAPI 400エラーを引き起こす可能性があったバグを修正
- SDK呼び出し元がアカウント情報を同期的に提供できるよう、`CLAUDE_CODE_ACCOUNT_UUID`、`CLAUDE_CODE_USER_EMAIL`、`CLAUDE_CODE_ORGANIZATION_UUID`環境変数を追加。これにより、初期のテレメトリイベントにアカウントメタデータが欠落する競合状態が解消されます。
- プラグインのSKILL.md説明がYAML配列やその他の非文字列型の場合にスラッシュコマンドのオートコンプリートがクラッシュする問題を修正
- `/model`ピッカーが、固定されたモデルバージョンに対して生のモデルIDではなく人間が読みやすいラベル（例：「Sonnet 4.5」）を表示するようになり、新しいバージョンが利用可能な場合はアップグレードのヒントが表示されます。
- 管理設定をmacOSのplistまたはWindowsレジストリ経由で設定できるようになりました。詳細は https://code.claude.com/docs/en/settings#settings-files をご覧ください

## 2.1.50

- LSPサーバーの`startupTimeout`設定のサポートを追加
- `WorktreeCreate`および`WorktreeRemove`フックイベントを追加。エージェントのワークツリー分離がワークツリーを作成または削除する際に、カスタムVCSのセットアップとクリーンアップが可能になります。
- 作業ディレクトリにシンボリックリンクが含まれる場合に、再開されたセッションが表示されなくなるバグを修正。セッションストレージパスが起動時の異なるタイミングで解決されていたことが原因でした。また、グレースフルシャットダウンシーケンスでフックと分析の前にセッションデータをフラッシュすることで、SSH切断時のセッションデータ損失を修正しました。
- Linux：glibc 2.30より古いシステム（例：RHEL 8）でネイティブモジュールが読み込まれない問題を修正
- エージェントチームで完了したチームメイトのタスクがセッション状態からガベージコレクションされないメモリリークを修正
- `CLAUDE_CODE_SIMPLE`を修正し、スキル、セッションメモリ、カスタムエージェント、CLAUDE.mdトークンカウントを完全に削除するようにしました
- `/mcp reconnect`で存在しないサーバー名を指定した場合にCLIがフリーズする問題を修正
- 完了したタスク状態オブジェクトがAppStateから削除されないメモリリークを修正
- エージェント定義で`isolation: worktree`のサポートを追加。エージェントが宣言的に分離されたgitワークツリーで実行できるようになります。
- `CLAUDE_CODE_SIMPLE`モードで、MCP ツール、添付ファイル、フック、CLAUDE.mdファイルの読み込みも無効化され、完全にミニマルな体験が提供されるようになりました。

## 2.1.56

- VS Code: 「command 'claude-vscode.editor.openLast' not found」クラッシュの別の原因を修正

## 2.1.55

- WindowsでBashToolがEINVALエラーで失敗する問題を修正

## 2.1.53

- ユーザー入力が送信後、メッセージがレンダリングされる前に一瞬消えるUIのちらつきを修正
- 一括エージェント終了（ctrl+f）を改善し、エージェントごとに1つずつではなく単一の集約通知を送信するようにし、コマンドキューを適切にクリアするように修正
- Remote Control使用時にグレースフルシャットダウンが古いセッションを残すことがある問題を、ネットワーク呼び出しの並列化により修正
- 初回起動時に`--worktree`が無視されることがある問題を修正
- Windowsで発生するパニック（「switch on corrupted value」）を修正
- Windowsで多数のプロセスを生成する際に発生する可能性があったクラッシュを修正
- Linux x64およびWindows x64でWebAssemblyインタープリターのクラッシュを修正
- Windows ARM64で2分後に発生することがあったクラッシュを修正

## 2.1.52

- VS Code: Windowsでの拡張機能クラッシュ（「command 'claude-vscode.editor.openLast' not found」）を修正

## 2.1.51

- 外部ビルド向けに`claude remote-control`サブコマンドを追加し、すべてのユーザーがローカル環境を提供できるようになりました
- プラグインマーケットプレイスのデフォルトgitタイムアウトを30秒から120秒に更新し、`CLAUDE_CODE_PLUGIN_GIT_TIMEOUT_MS`で設定可能にしました
- npmソースからプラグインをインストールする際のカスタムnpmレジストリと特定バージョンの固定をサポート
- BashToolは、シェルスナップショットが利用可能な場合、デフォルトでログインシェル（`-l`フラグ）をスキップするようになり、コマンド実行のパフォーマンスが向上しました。以前はこれに`CLAUDE_BASH_NO_LOGIN=true`の設定が必要でした
- インタラクティブモードで`statusLine`および`fileSuggestion`フックコマンドがワークスペースの信頼承認なしで実行できてしまうセキュリティ問題を修正
- 50K文字を超えるツール結果はディスクに永続化されるようになりました（以前は100K）。これによりコンテキストウィンドウの使用量が削減され、会話の継続性が向上します
- 重複した`control_response`メッセージ（WebSocket再接続時など）が会話に重複したアシスタントメッセージをプッシュし、API 400エラーを引き起こす可能性があったバグを修正
- SDK呼び出し元がアカウント情報を同期的に提供できるよう、`CLAUDE_CODE_ACCOUNT_UUID`、`CLAUDE_CODE_USER_EMAIL`、`CLAUDE_CODE_ORGANIZATION_UUID`環境変数を追加。これにより、初期のテレメトリーイベントにアカウントメタデータが欠落する競合状態を解消しました
- プラグインのSKILL.md説明がYAML配列やその他の非文字列型の場合にスラッシュコマンドのオートコンプリートがクラッシュする問題を修正
- `/model`ピッカーが、固定されたモデルバージョンに対して生のモデルIDではなく人間が読みやすいラベル（例:「Sonnet 4.5」）を表示するようになり、新しいバージョンが利用可能な場合はアップグレードのヒントを表示します
- 管理設定をmacOSのplistまたはWindowsレジストリ経由で設定できるようになりました。詳細は https://code.claude.com/docs/en/settings#settings-files をご覧ください

## 2.1.50

- LSPサーバーの`startupTimeout`設定のサポートを追加
- `WorktreeCreate`および`WorktreeRemove`フックイベントを追加し、エージェントのworktree分離がworktreeを作成または削除する際にカスタムVCSのセットアップとクリーンアップを可能にしました
- 作業ディレクトリにシンボリックリンクが含まれる場合、再開されたセッションが見えなくなる可能性があったバグを修正。セッションストレージパスが起動時の異なるタイミングで解決されていたことが原因でした。また、グレースフルシャットダウンシーケンスでフックと分析の前にセッションデータをフラッシュすることで、SSH切断時のセッションデータ損失を修正しました
- Linux: glibc 2.30より古いシステム（例:RHEL 8）でネイティブモジュールが読み込まれない問題を修正
- エージェントチームで完了したチームメイトのタスクがセッション状態からガベージコレクションされないメモリリークを修正
- `CLAUDE_CODE_SIMPLE`がスキル、セッションメモリ、カスタムエージェント、CLAUDE.mdトークンカウントを完全に削減するように修正
- 存在しないサーバー名を指定した場合に`/mcp reconnect`がCLIをフリーズさせる問題を修正
- 完了したタスク状態オブジェクトがAppStateから削除されないメモリリークを修正
- エージェント定義に`isolation: worktree`のサポートを追加し、エージェントが宣言的に分離されたgit worktreeで実行できるようになりました
- `CLAUDE_CODE_SIMPLE`モードで、MCPツール、添付ファイル、フック、CLAUDE.mdファイルの読み込みも無効化し、完全にミニマルな体験を提供するようになりました
- ツール検索が有効で、起動引数としてプロンプトが渡された場合にMCPツールが検出されないバグを修正
- コンパクション後に内部キャッシュをクリアすることで、長時間のセッション中のメモリ使用量を改善
- 設定されたすべてのエージェントをリストする`claude agents` CLIコマンドを追加
- 大きなツール結果を処理後にクリアすることで、長時間のセッション中のメモリ使用量を改善

## 2.1.55

- Windows上でBashToolがEINVALエラーで失敗する問題を修正

## 2.1.53

- ユーザー入力が送信後、メッセージがレンダリングされる前に一瞬消えるUIのちらつきを修正
- エージェントの一括終了（ctrl+f）を改善し、エージェントごとに1つずつではなく単一の集約通知を送信するようにし、コマンドキューを適切にクリアするように修正
- Remote Control使用時にグレースフルシャットダウンが古いセッションを残すことがある問題を、ネットワーク呼び出しの並列化により修正
- 初回起動時に`--worktree`が無視されることがある問題を修正
- Windowsで発生するパニック（"switch on corrupted value"）を修正
- Windowsで多数のプロセスを生成する際に発生する可能性があったクラッシュを修正
- Linux x64およびWindows x64でWebAssemblyインタープリターで発生するクラッシュを修正
- Windows ARM64で2分後に発生することがあったクラッシュを修正

## 2.1.52

- VS Code: Windowsでの拡張機能クラッシュ（"command 'claude-vscode.editor.openLast' not found"）を修正

## 2.1.51

- 外部ビルド向けに`claude remote-control`サブコマンドを追加し、すべてのユーザーがローカル環境を提供できるようになりました
- プラグインマーケットプレイスのデフォルトgitタイムアウトを30秒から120秒に更新し、`CLAUDE_CODE_PLUGIN_GIT_TIMEOUT_MS`で設定可能にしました
- npmソースからプラグインをインストールする際のカスタムnpmレジストリと特定バージョンの固定をサポート
- BashToolは、シェルスナップショットが利用可能な場合、デフォルトでログインシェル（`-l`フラグ）をスキップするようになり、コマンド実行のパフォーマンスが向上しました。以前はこれに`CLAUDE_BASH_NO_LOGIN=true`の設定が必要でした
- インタラクティブモードでワークスペースの信頼承認なしに`statusLine`および`fileSuggestion`フックコマンドが実行される可能性があったセキュリティ問題を修正
- 50K文字を超えるツール結果はディスクに永続化されるようになりました（以前は100K）。これによりコンテキストウィンドウの使用量が削減され、会話の持続時間が向上します
- 重複した`control_response`メッセージ（WebSocket再接続などによる）が、重複したアシスタントメッセージを会話に追加してAPI 400エラーを引き起こす可能性があったバグを修正
- SDK呼び出し元がアカウント情報を同期的に提供できるよう、`CLAUDE_CODE_ACCOUNT_UUID`、`CLAUDE_CODE_USER_EMAIL`、`CLAUDE_CODE_ORGANIZATION_UUID`環境変数を追加し、初期のテレメトリイベントにアカウントメタデータが欠けていた競合状態を解消しました
- プラグインのSKILL.md説明がYAML配列やその他の非文字列型の場合にスラッシュコマンドのオートコンプリートがクラッシュする問題を修正
- `/model`ピッカーが、固定されたモデルバージョンに対して生のモデルIDではなく人間が読みやすいラベル（例：「Sonnet 4.5」）を表示するようになり、新しいバージョンが利用可能な場合はアップグレードのヒントを表示します
- 管理設定をmacOSのplistまたはWindowsレジストリ経由で設定できるようになりました。詳細は https://code.claude.com/docs/en/settings#settings-files をご覧ください

## 2.1.50

- LSPサーバーの`startupTimeout`設定のサポートを追加
- `WorktreeCreate`および`WorktreeRemove`フックイベントを追加し、エージェントのワークツリー分離がワークツリーを作成または削除する際にカスタムVCSのセットアップとクリーンアップを可能にしました
- 作業ディレクトリにシンボリックリンクが含まれる場合、セッションストレージパスが起動時の異なるタイミングで解決されるため、再開されたセッションが見えなくなるバグを修正。また、グレースフルシャットダウンシーケンスでフックと分析の前にセッションデータをフラッシュすることで、SSH切断時のセッションデータ損失を修正しました
- Linux: glibc 2.30より古いシステム（例：RHEL 8）でネイティブモジュールが読み込まれない問題を修正
- エージェントチームで完了したチームメイトタスクがセッション状態からガベージコレクションされないメモリリークを修正
- `CLAUDE_CODE_SIMPLE`がスキル、セッションメモリ、カスタムエージェント、CLAUDE.mdトークンカウントを完全に削減するように修正
- 存在しないサーバー名が指定された場合に`/mcp reconnect`がCLIをフリーズさせる問題を修正
- 完了したタスク状態オブジェクトがAppStateから削除されないメモリリークを修正
- エージェント定義で`isolation: worktree`のサポートを追加し、エージェントが宣言的に分離されたgitワークツリーで実行できるようになりました
- `CLAUDE_CODE_SIMPLE`モードで、MCPツール、添付ファイル、フック、CLAUDE.mdファイルの読み込みも無効化し、完全にミニマルな体験を提供するようになりました
- ツール検索が有効で、起動引数としてプロンプトが渡された場合にMCPツールが検出されないバグを修正
- 長時間のセッション中のメモリ使用量を、圧縮後に内部キャッシュをクリアすることで改善
- すべての設定済みエージェントをリストする`claude agents` CLIコマンドを追加
- 長時間のセッション中のメモリ使用量を、処理後に大きなツール結果をクリアすることで改善
- LSP診断データが配信後にクリーンアップされず、長時間のセッションで無制限にメモリが増加するメモリリークを修正
- 完了したタスク出力がメモリから解放されないメモリリークを修正し、多数のタスクを含む長時間のセッションでのメモリ使用量を削減
- ヘッドレスモード（`-p`フラグ）の起動パフォーマンスを、Yoga WASMとUIコンポーネントのインポートを遅延させることで改善
- プロンプト提案キャッシュのキャッシュヒット率を低下させていた回帰を修正

## 2.1.53

- ユーザー入力が送信後、メッセージがレンダリングされる前に一瞬消える UI のちらつきを修正
- エージェントの一括終了（ctrl+f）で、エージェントごとに1つずつではなく単一の集約通知を送信するように修正し、コマンドキューを適切にクリアするように改善
- Remote Control 使用時に、グレースフルシャットダウンで古いセッションが残ることがある問題を、ネットワーク呼び出しの並列化により修正
- `--worktree` が初回起動時に無視されることがある問題を修正
- Windows で panic（「switch on corrupted value」）が発生する問題を修正
- Windows で多数のプロセスを起動する際にクラッシュする可能性がある問題を修正
- Linux x64 および Windows x64 で WebAssembly インタープリターがクラッシュする問題を修正
- Windows ARM64 で2分後にクラッシュすることがある問題を修正

## 2.1.52

- VS Code: Windows での拡張機能のクラッシュ（「command 'claude-vscode.editor.openLast' not found」）を修正

## 2.1.51

- 外部ビルド向けに `claude remote-control` サブコマンドを追加し、すべてのユーザーがローカル環境を提供できるように改善
- プラグインマーケットプレイスのデフォルト git タイムアウトを30秒から120秒に更新し、`CLAUDE_CODE_PLUGIN_GIT_TIMEOUT_MS` で設定可能に
- npm ソースからプラグインをインストールする際のカスタム npm レジストリと特定バージョンの固定に対応
- BashTool は、シェルスナップショットが利用可能な場合、デフォルトでログインシェル（`-l` フラグ）をスキップするようになり、コマンド実行のパフォーマンスが向上。以前は `CLAUDE_BASH_NO_LOGIN=true` の設定が必要でした
- インタラクティブモードで、`statusLine` および `fileSuggestion` フックコマンドがワークスペースの信頼承認なしで実行できてしまうセキュリティ問題を修正
- 50K 文字を超えるツール結果はディスクに保存されるようになりました（以前は100K）。これによりコンテキストウィンドウの使用量が削減され、会話の持続性が向上
- 重複した `control_response` メッセージ（WebSocket 再接続時など）が、会話に重複したアシスタントメッセージをプッシュして API 400 エラーを引き起こす可能性があるバグを修正
- SDK 呼び出し元がアカウント情報を同期的に提供できるよう、`CLAUDE_CODE_ACCOUNT_UUID`、`CLAUDE_CODE_USER_EMAIL`、`CLAUDE_CODE_ORGANIZATION_UUID` 環境変数を追加。これにより、初期のテレメトリーイベントにアカウントメタデータが欠落する競合状態を解消
- プラグインの SKILL.md の説明が YAML 配列やその他の非文字列型の場合にスラッシュコマンドのオートコンプリートがクラッシュする問題を修正
- `/model` ピッカーで、固定されたモデルバージョンに対して生の モデル ID ではなく人間が読みやすいラベル（例:「Sonnet 4.5」）を表示するようになり、新しいバージョンが利用可能な場合はアップグレードのヒントを表示
- 管理設定を macOS の plist または Windows レジストリ経由で設定できるようになりました。詳細は https://code.claude.com/docs/en/settings#settings-files を参照

## 2.1.50

- LSP サーバーの `startupTimeout` 設定に対応
- `WorktreeCreate` および `WorktreeRemove` フックイベントを追加し、エージェントのワークツリー分離がワークツリーを作成または削除する際にカスタム VCS のセットアップとクリーンアップを可能に
- 作業ディレクトリにシンボリックリンクが含まれる場合、再開されたセッションが見えなくなるバグを修正。これは、起動時の異なるタイミングでセッションストレージパスが解決されていたことが原因。また、グレースフルシャットダウンシーケンスでフックと分析の前にセッションデータをフラッシュすることで、SSH 切断時のセッションデータ損失を修正
- Linux: glibc 2.30 より古いシステム（例: RHEL 8）でネイティブモジュールが読み込まれない問題を修正
- エージェントチームで、完了したチームメイトのタスクがセッション状態からガベージコレクションされないメモリリークを修正
- `CLAUDE_CODE_SIMPLE` でスキル、セッションメモリ、カスタムエージェント、CLAUDE.md トークンカウントを完全に削減するように修正
- 存在しないサーバー名を指定した場合に `/mcp reconnect` が CLI をフリーズさせる問題を修正
- 完了したタスク状態オブジェクトが AppState から削除されないメモリリークを修正
- エージェント定義で `isolation: worktree` をサポートし、エージェントが宣言的に分離された git ワークツリーで実行できるように改善
- `CLAUDE_CODE_SIMPLE` モードで、MCP ツール、添付ファイル、フック、CLAUDE.md ファイルの読み込みも無効化し、完全にミニマルな体験を提供
- ツール検索が有効で、起動引数としてプロンプトが渡された場合に MCP ツールが検出されないバグを修正
- コンパクション後に内部キャッシュをクリアすることで、長時間のセッション中のメモリ使用量を改善
- すべての設定済みエージェントをリストする `claude agents` CLI コマンドを追加
- 大きなツール結果を処理後にクリアすることで、長時間のセッション中のメモリ使用量を改善
- LSP 診断データが配信後にクリーンアップされず、長時間のセッションで無制限にメモリが増加するメモリリークを修正
- 完了したタスク出力がメモリから解放されないメモリリークを修正し、多数のタスクを含む長時間のセッションでのメモリ使用量を削減
- ヘッドレスモード（`-p` フラグ）の起動パフォーマンスを、Yoga WASM と UI コンポーネントのインポートを遅延させることで改善
- キャッシュヒット率を低下させていたプロンプト提案キャッシュのリグレッションを修正
- ファイル履歴スナップショットに上限を設けることで、長時間のセッションでの無制限なメモリ増加を修正
- 1M コンテキストウィンドウサポートを無効化する `CLAUDE_CODE_DISABLE_1M_CONTEXT` 環境変数を追加
- Opus 4.6（高速モード）に完全な 1M コンテキストウィンドウを含めるように改善
- VSCode: VS Code セッションで `/extra-usage` コマンドのサポートを追加
- TaskOutput がクリーンアップ後も最近の行を保持するメモリリークを修正
- CircularBuffer でクリアされた項目がバッキング配列に保持されるメモリリークを修正
- シェルコマンド実行で、クリーンアップ後も ChildProcess と AbortController の参照が保持されるメモリリークを修正

## 2.1.49

- MCP OAuth 認証を改善し、ステップアップ認証のサポートとディスカバリーキャッシングを追加することで、サーバー接続時の冗長なネットワークリクエストを削減

## 2.1.52

- VS Code: Windows環境で拡張機能がクラッシュする問題を修正（「command 'claude-vscode.editor.openLast' not found」エラー）

## 2.1.51

- 外部ビルド向けに`claude remote-control`サブコマンドを追加し、すべてのユーザーがローカル環境を提供できるようになりました。
- プラグインマーケットプレイスのデフォルトgitタイムアウトを30秒から120秒に更新し、`CLAUDE_CODE_PLUGIN_GIT_TIMEOUT_MS`で設定可能にしました。
- npmソースからプラグインをインストールする際に、カスタムnpmレジストリと特定バージョンの固定に対応しました。
- BashToolは、シェルスナップショットが利用可能な場合、デフォルトでログインシェル（`-l`フラグ）をスキップするようになり、コマンド実行のパフォーマンスが向上しました。以前はこれに`CLAUDE_BASH_NO_LOGIN=true`の設定が必要でした。
- インタラクティブモードで、`statusLine`と`fileSuggestion`フックコマンドがワークスペースの信頼承認なしで実行できてしまうセキュリティ問題を修正しました。
- 50K文字を超えるツール結果がディスクに保存されるようになりました（以前は100K）。これによりコンテキストウィンドウの使用量が削減され、会話の持続時間が改善されます。
- 重複した`control_response`メッセージ（WebSocket再接続時など）が、会話に重複したアシスタントメッセージを追加してAPI 400エラーを引き起こす可能性があったバグを修正しました。
- SDK呼び出し元がアカウント情報を同期的に提供できるよう、`CLAUDE_CODE_ACCOUNT_UUID`、`CLAUDE_CODE_USER_EMAIL`、`CLAUDE_CODE_ORGANIZATION_UUID`環境変数を追加しました。これにより、初期のテレメトリイベントにアカウントメタデータが欠落する競合状態が解消されます。
- プラグインのSKILL.md説明がYAML配列やその他の非文字列型の場合にスラッシュコマンドのオートコンプリートがクラッシュする問題を修正しました。
- `/model`ピッカーが、固定されたモデルバージョンに対して生のモデルIDではなく人間が読みやすいラベル（例：「Sonnet 4.5」）を表示するようになり、新しいバージョンが利用可能な場合はアップグレードのヒントが表示されます。
- 管理設定をmacOSのplistまたはWindowsレジストリ経由で設定できるようになりました。詳細は https://code.claude.com/docs/en/settings#settings-files をご覧ください。

## 2.1.50

- LSPサーバーの`startupTimeout`設定に対応しました。
- `WorktreeCreate`と`WorktreeRemove`フックイベントを追加し、エージェントのワークツリー分離がワークツリーを作成・削除する際にカスタムVCSのセットアップとクリーンアップが可能になりました。
- 作業ディレクトリにシンボリックリンクが含まれる場合に、再開されたセッションが表示されなくなるバグを修正しました。これは、起動時の異なるタイミングでセッションストレージパスが解決されていたためです。また、グレースフルシャットダウンシーケンスでフックと分析の前にセッションデータをフラッシュすることで、SSH切断時のセッションデータ損失を修正しました。
- Linux: glibc 2.30より古いシステム（例：RHEL 8）でネイティブモジュールが読み込まれない問題を修正しました。
- エージェントチームで完了したチームメイトのタスクがセッション状態からガベージコレクションされないメモリリークを修正しました。
- `CLAUDE_CODE_SIMPLE`がスキル、セッションメモリ、カスタムエージェント、CLAUDE.mdトークンカウントを完全に削減するよう修正しました。
- 存在しないサーバー名を指定した場合に`/mcp reconnect`がCLIをフリーズさせる問題を修正しました。
- 完了したタスク状態オブジェクトがAppStateから削除されないメモリリークを修正しました。
- エージェント定義で`isolation: worktree`に対応し、エージェントが宣言的に分離されたgitワークツリーで実行できるようになりました。
- `CLAUDE_CODE_SIMPLE`モードで、MCP、ツール、アタッチメント、フック、CLAUDE.mdファイルの読み込みも無効化され、完全に最小限の体験が提供されるようになりました。
- ツール検索が有効で、起動引数としてプロンプトが渡された場合にMCPツールが検出されないバグを修正しました。
- 圧縮後に内部キャッシュをクリアすることで、長時間のセッション中のメモリ使用量を改善しました。
- 設定されたすべてのエージェントをリストする`claude agents` CLIコマンドを追加しました。
- 処理後に大きなツール結果をクリアすることで、長時間のセッション中のメモリ使用量を改善しました。
- LSP診断データが配信後にクリーンアップされず、長時間のセッションで無制限にメモリが増加するメモリリークを修正しました。
- 完了したタスク出力がメモリから解放されないメモリリークを修正し、多数のタスクを含む長時間のセッションでのメモリ使用量を削減しました。
- Yoga WASMとUIコンポーネントのインポートを遅延させることで、ヘッドレスモード（`-p`フラグ）の起動パフォーマンスを改善しました。
- キャッシュヒット率を低下させていたプロンプト提案キャッシュのリグレッションを修正しました。
- ファイル履歴スナップショットに上限を設けることで、長時間のセッションでの無制限なメモリ増加を修正しました。
- 1Mコンテキストウィンドウサポートを無効化する`CLAUDE_CODE_DISABLE_1M_CONTEXT`環境変数を追加しました。
- Opus 4.6（高速モード）に完全な1Mコンテキストウィンドウが含まれるようになりました。
- VSCode: VS Codeセッションで`/extra-usage`コマンドに対応しました。
- TaskOutputがクリーンアップ後も最近の行を保持していたメモリリークを修正しました。
- CircularBufferでクリアされた項目がバッキング配列に保持されていたメモリリークを修正しました。
- シェルコマンド実行時にChildProcessとAbortControllerの参照がクリーンアップ後も保持されていたメモリリークを修正しました。

## 2.1.49

- ステップアップ認証サポートとディスカバリキャッシングによりMCP OAuth認証を改善し、サーバー接続時の冗長なネットワークリクエストを削減しました。
- 分離されたgitワークツリーでClaudeを起動する`--worktree`（`-w`）フラグを追加しました。

## 2.1.52

- VS Code：Windowsでの拡張機能クラッシュを修正（「command 'claude-vscode.editor.openLast' not found」エラー）

## 2.1.51

- 外部ビルド向けに`claude remote-control`サブコマンドを追加し、すべてのユーザーがローカル環境を提供できるようになりました。
- プラグインマーケットプレイスのデフォルトgitタイムアウトを30秒から120秒に更新し、`CLAUDE_CODE_PLUGIN_GIT_TIMEOUT_MS`で設定可能にしました。
- npmソースからプラグインをインストールする際に、カスタムnpmレジストリと特定バージョンの固定をサポートしました。
- BashToolは、シェルスナップショットが利用可能な場合、デフォルトでログインシェル（`-l`フラグ）をスキップするようになり、コマンド実行のパフォーマンスが向上しました。以前はこれに`CLAUDE_BASH_NO_LOGIN=true`の設定が必要でした。
- インタラクティブモードで`statusLine`と`fileSuggestion`フックコマンドがワークスペースの信頼承認なしに実行される可能性があったセキュリティ問題を修正しました。
- 50K文字を超えるツール結果がディスクに保存されるようになりました（以前は100K）。これによりコンテキストウィンドウの使用量が削減され、会話の持続性が向上します。
- WebSocket再接続などによる重複した`control_response`メッセージが、会話に重複したアシスタントメッセージをプッシュしてAPI 400エラーを引き起こす可能性があったバグを修正しました。
- SDK呼び出し元がアカウント情報を同期的に提供できるよう、`CLAUDE_CODE_ACCOUNT_UUID`、`CLAUDE_CODE_USER_EMAIL`、`CLAUDE_CODE_ORGANIZATION_UUID`環境変数を追加しました。これにより、初期のテレメトリーイベントにアカウントメタデータが欠落する競合状態が解消されます。
- プラグインのSKILL.md説明がYAML配列やその他の非文字列型の場合にスラッシュコマンドのオートコンプリートがクラッシュする問題を修正しました。
- `/model`ピッカーが、固定されたモデルバージョンに対して生のモデルIDではなく人間が読みやすいラベル（例：「Sonnet 4.5」）を表示するようになり、新しいバージョンが利用可能な場合はアップグレードのヒントが表示されます。

## 2.1.50

- LSPサーバーの`startupTimeout`設定をサポートしました。
- `WorktreeCreate`と`WorktreeRemove`フックイベントを追加し、エージェントのワークツリー分離がワークツリーを作成または削除する際にカスタムVCSのセットアップとクリーンアップが可能になりました。
- 作業ディレクトリにシンボリックリンクが含まれる場合に、セッションストレージパスが起動時の異なるタイミングで解決されるため、再開されたセッションが見えなくなるバグを修正しました。また、グレースフルシャットダウンシーケンスでフックと分析の前にセッションデータをフラッシュすることで、SSH切断時のセッションデータ損失を修正しました。
- Linux：glibc 2.30より古いシステム（例：RHEL 8）でネイティブモジュールが読み込まれない問題を修正しました。
- エージェントチームで完了したチームメイトのタスクがセッション状態からガベージコレクションされないメモリリークを修正しました。
- `CLAUDE_CODE_SIMPLE`がスキル、セッションメモリ、カスタムエージェント、CLAUDE.mdトークンカウントを完全に削減するように修正しました。
- 存在しないサーバー名を指定した場合に`/mcp reconnect`がCLIをフリーズさせる問題を修正しました。
- 完了したタスク状態オブジェクトがAppStateから削除されないメモリリークを修正しました。
- エージェント定義で`isolation: worktree`をサポートし、エージェントが宣言的に分離されたgitワークツリーで実行できるようになりました。
- `CLAUDE_CODE_SIMPLE`モードで、MCPツール、添付ファイル、フック、CLAUDE.mdファイル読み込みも無効化し、完全にミニマルな体験を提供するようになりました。
- ツール検索が有効で、起動引数としてプロンプトが渡された場合にMCPツールが検出されないバグを修正しました。
- コンパクション後に内部キャッシュをクリアすることで、長時間セッション中のメモリ使用量を改善しました。
- すべての設定済みエージェントをリスト表示する`claude agents` CLIコマンドを追加しました。
- 処理後に大きなツール結果をクリアすることで、長時間セッション中のメモリ使用量を改善しました。
- LSP診断データが配信後にクリーンアップされず、長時間セッションで無制限にメモリが増加するメモリリークを修正しました。
- 完了したタスク出力がメモリから解放されないメモリリークを修正し、多数のタスクを含む長時間セッションでのメモリ使用量を削減しました。
- Yoga WASMとUIコンポーネントのインポートを遅延させることで、ヘッドレスモード（`-p`フラグ）の起動パフォーマンスを改善しました。
- キャッシュヒット率を低下させていたプロンプト提案キャッシュの不具合を修正しました。
- ファイル履歴スナップショットに上限を設けることで、長時間セッションでの無制限なメモリ増加を修正しました。
- 1Mコンテキストウィンドウサポートを無効化する`CLAUDE_CODE_DISABLE_1M_CONTEXT`環境変数を追加しました。
- Opus 4.6（高速モード）に完全な1Mコンテキストウィンドウが含まれるようになりました。
- VSCode：VS Codeセッションで`/extra-usage`コマンドをサポートしました。
- TaskOutputがクリーンアップ後も最近の行を保持していたメモリリークを修正しました。
- CircularBufferでクリアされた項目がバッキング配列に保持されていたメモリリークを修正しました。
- シェルコマンド実行でChildProcessとAbortControllerの参照がクリーンアップ後も保持されていたメモリリークを修正しました。

## 2.1.49

- ステップアップ認証サポートとディスカバリーキャッシングによりMCP OAuth認証を改善し、サーバー接続時の冗長なネットワークリクエストを削減しました。
- 分離されたgitワークツリーでClaudeを起動する`--worktree`（`-w`）フラグを追加しました。
- サブエージェントが一時的なgitワークツリーで作業するための`isolation: "worktree"`をサポートしました。
- バックグラウンドエージェントを終了するCtrl+Fキーバインドを追加しました（2回押しで確認）。
- エージェント定義で常にバックグラウンドタスクとして実行するための`background: true`をサポートしました。
- プラグインがデフォルト設定用の`settings.json`を同梱できるようになりました。

## 2.1.51

- 外部ビルド向けに`claude remote-control`サブコマンドを追加し、すべてのユーザーがローカル環境を提供できるようになりました。
- プラグインマーケットプレイスのデフォルトgitタイムアウトを30秒から120秒に更新し、`CLAUDE_CODE_PLUGIN_GIT_TIMEOUT_MS`で設定可能にしました。
- npmソースからプラグインをインストールする際に、カスタムnpmレジストリと特定バージョンの固定をサポートしました。
- BashToolは、シェルスナップショットが利用可能な場合、デフォルトでログインシェル(`-l`フラグ)をスキップするようになり、コマンド実行のパフォーマンスが向上しました。以前はこれに`CLAUDE_BASH_NO_LOGIN=true`の設定が必要でした。
- インタラクティブモードで`statusLine`と`fileSuggestion`フックコマンドがワークスペースの信頼承認なしに実行される可能性があったセキュリティ問題を修正しました。
- 50K文字を超えるツール結果がディスクに保存されるようになりました(以前は100K)。これによりコンテキストウィンドウの使用量が削減され、会話の持続時間が改善されます。
- 重複した`control_response`メッセージ(WebSocket再接続時など)が、会話に重複したアシスタントメッセージをプッシュしてAPI 400エラーを引き起こすバグを修正しました。
- SDK呼び出し元がアカウント情報を同期的に提供できるよう、`CLAUDE_CODE_ACCOUNT_UUID`、`CLAUDE_CODE_USER_EMAIL`、`CLAUDE_CODE_ORGANIZATION_UUID`環境変数を追加しました。これにより、初期のテレメトリイベントにアカウントメタデータが欠落する競合状態が解消されます。
- プラグインのSKILL.md説明がYAML配列やその他の非文字列型の場合にスラッシュコマンドのオートコンプリートがクラッシュする問題を修正しました。
- `/model`ピッカーが、固定されたモデルバージョンに対して生のモデルIDではなく人間が読みやすいラベル(例:「Sonnet 4.5」)を表示するようになり、新しいバージョンが利用可能な場合はアップグレードのヒントが表示されます。

## 2.1.50

- LSPサーバーの`startupTimeout`設定をサポートしました。
- `WorktreeCreate`と`WorktreeRemove`フックイベントを追加し、エージェントのワークツリー分離がワークツリーを作成または削除する際にカスタムVCSのセットアップとクリーンアップを可能にしました。
- 作業ディレクトリにシンボリックリンクが含まれる場合、再開されたセッションが見えなくなるバグを修正しました。これは、起動時の異なるタイミングでセッションストレージパスが解決されていたためです。また、グレースフルシャットダウンシーケンスでフックと分析の前にセッションデータをフラッシュすることで、SSH切断時のセッションデータ損失を修正しました。
- Linux: glibc 2.30より古いシステム(例:RHEL 8)でネイティブモジュールが読み込まれない問題を修正しました。
- エージェントチームで完了したチームメイトのタスクがセッション状態からガベージコレクションされないメモリリークを修正しました。
- `CLAUDE_CODE_SIMPLE`がスキル、セッションメモリ、カスタムエージェント、CLAUDE.mdトークンカウントを完全に削除するよう修正しました。
- 存在しないサーバー名を指定した場合に`/mcp reconnect`がCLIをフリーズさせる問題を修正しました。
- 完了したタスク状態オブジェクトがAppStateから削除されないメモリリークを修正しました。
- エージェント定義で`isolation: worktree`をサポートし、エージェントが分離されたgitワークツリーで宣言的に実行できるようになりました。
- `CLAUDE_CODE_SIMPLE`モードで、MCPツール、添付ファイル、フック、CLAUDE.mdファイルの読み込みも無効化され、完全にミニマルな体験を提供します。
- ツール検索が有効で、起動引数としてプロンプトが渡された場合にMCPツールが検出されないバグを修正しました。
- 圧縮後に内部キャッシュをクリアすることで、長時間セッション中のメモリ使用量を改善しました。
- すべての設定済みエージェントをリストする`claude agents` CLIコマンドを追加しました。
- 処理後に大きなツール結果をクリアすることで、長時間セッション中のメモリ使用量を改善しました。
- LSP診断データが配信後にクリーンアップされず、長時間セッションで無制限のメモリ増加を引き起こすメモリリークを修正しました。
- 完了したタスク出力がメモリから解放されないメモリリークを修正し、多数のタスクを含む長時間セッションでのメモリ使用量を削減しました。
- Yoga WASMとUIコンポーネントのインポートを遅延させることで、ヘッドレスモード(`-p`フラグ)の起動パフォーマンスを改善しました。
- プロンプト提案キャッシュのリグレッションによりキャッシュヒット率が低下していた問題を修正しました。
- ファイル履歴スナップショットに上限を設けることで、長時間セッションでの無制限のメモリ増加を修正しました。
- 1Mコンテキストウィンドウサポートを無効化する`CLAUDE_CODE_DISABLE_1M_CONTEXT`環境変数を追加しました。
- Opus 4.6(高速モード)に完全な1Mコンテキストウィンドウが含まれるようになりました。
- VSCode: VS Codeセッションで`/extra-usage`コマンドのサポートを追加しました。
- TaskOutputがクリーンアップ後も最近の行を保持するメモリリークを修正しました。
- CircularBufferでクリアされた項目がバッキング配列に保持されるメモリリークを修正しました。
- シェルコマンド実行でChildProcessとAbortControllerの参照がクリーンアップ後も保持されるメモリリークを修正しました。

## 2.1.49

- ステップアップ認証サポートとディスカバリキャッシングによりMCP OAuth認証を改善し、サーバー接続時の冗長なネットワークリクエストを削減しました。
- 分離されたgitワークツリーでClaudeを起動する`--worktree`(`-w`)フラグを追加しました。
- サブエージェントが一時的なgitワークツリーで作業するための`isolation: "worktree"`をサポートしました。
- バックグラウンドエージェントを終了するCtrl+Fキーバインディングを追加しました(2回押しで確認)。
- エージェント定義で常にバックグラウンドタスクとして実行する`background: true`をサポートしました。
- プラグインがデフォルト設定用の`settings.json`を同梱できるようになりました。
- モデルがリポジトリフォルダを省略した場合、ファイル未検出エラーで修正されたパスを提案するようになりました。
- バックグラウンドエージェントが実行中でメインスレッドがアイドル状態の場合、Ctrl+CとESCが無視される問題を修正しました。3秒以内に2回押すとすべてのバックグラウンドエージェントが終了します。
- プロンプト提案キャッシュのリグレッションによりキャッシュヒット率が低下していた問題を修正しました。
- `plugin enable`と`plugin disable`で`--scope`が指定されていない場合、常にユーザースコープをデフォルトとするのではなく、正しいスコープを自動検出するようになりました。
- シンプルモード(`CLAUDE_CODE_SIMPLE`)にBashツールに加えてファイル編集ツールが含まれるようになり、シンプルモードで直接ファイル編集が可能になりました。
- 安全性チェックがask応答をトリガーした際に権限提案が入力されるようになり、SDKコンシューマーが権限オプションを表示できるようになりました。
- 1Mコンテキストを持つSonnet 4.5がMaxプランから削除され、同じく1Mコンテキストを持つ最先端のSonnet 4.6モデルに置き換えられます。/modelで切り替えてください。
- `/config`経由でトグルした際に詳細モードがシンキングブロック表示を更新しない問題を修正しました — メモコンパレーターが詳細モードの変更を正しく検出するようになりました。
- tree-sitterパーサーを定期的にリセットすることで、長時間セッション中の無制限のWASMメモリ増加を修正しました。
- 古いyogaレイアウト参照によって引き起こされる潜在的なレンダリング問題を修正しました。
- 起動時の不要なAPI呼び出しをスキップすることで、非インタラクティブモード(`-p`)のパフォーマンスを改善しました。
- HTTPおよびSSE MCPサーバーの認証失敗をキャッシュすることでパフォーマンスを改善し、認証が必要なサーバーへの繰り返し接続試行を回避しました。
- Yoga WASMリニアメモリが縮小されないことによる長時間実行セッション中の無制限のメモリ増加を修正しました。

## 2.1.50

- LSPサーバーの`startupTimeout`設定のサポートを追加
- `WorktreeCreate`と`WorktreeRemove`フックイベントを追加。エージェントのワークツリー分離機能がワークツリーを作成・削除する際に、カスタムVCSのセットアップとクリーンアップが可能に
- 作業ディレクトリにシンボリックリンクが含まれる場合に、再開されたセッションが表示されない不具合を修正。起動時にセッションストレージパスが異なるタイミングで解決されることが原因でした。また、グレースフルシャットダウンシーケンスでフックと分析の前にセッションデータをフラッシュすることで、SSH切断時のセッションデータ損失を修正
- Linux: glibc 2.30より古いシステム（RHEL 8など）でネイティブモジュールが読み込まれない問題を修正
- エージェントチームで完了したチームメイトのタスクがセッション状態からガベージコレクションされないメモリリークを修正
- `CLAUDE_CODE_SIMPLE`でスキル、セッションメモリ、カスタムエージェント、CLAUDE.mdのトークンカウントを完全に無効化するよう修正
- 存在しないサーバー名を指定した際に`/mcp reconnect`がCLIをフリーズさせる問題を修正
- 完了したタスク状態オブジェクトがAppStateから削除されないメモリリークを修正
- エージェント定義で`isolation: worktree`のサポートを追加。エージェントが宣言的に分離されたgitワークツリーで実行できるようになりました
- `CLAUDE_CODE_SIMPLE`モードでMCPツール、添付ファイル、フック、CLAUDE.mdファイルの読み込みも無効化し、完全にミニマルな体験を提供
- ツール検索が有効で、起動引数としてプロンプトが渡された場合にMCPツールが検出されない不具合を修正
- コンパクション後に内部キャッシュをクリアすることで、長時間セッション中のメモリ使用量を改善
- 設定されたすべてのエージェントをリスト表示する`claude agents` CLIコマンドを追加
- 処理後に大きなツール結果をクリアすることで、長時間セッション中のメモリ使用量を改善
- LSP診断データが配信後にクリーンアップされず、長時間セッションでメモリが無制限に増加するメモリリークを修正
- 完了したタスク出力がメモリから解放されないメモリリークを修正。多数のタスクを含む長時間セッションでのメモリ使用量を削減
- ヘッドレスモード（`-p`フラグ）の起動パフォーマンスを改善。Yoga WASMとUIコンポーネントのインポートを遅延させることで実現
- プロンプトサジェスチョンキャッシュのリグレッションを修正。キャッシュヒット率が低下していた問題を解消
- ファイル履歴スナップショットに上限を設けることで、長時間セッションでのメモリ無制限増加を修正
- 1Mコンテキストウィンドウサポートを無効化する`CLAUDE_CODE_DISABLE_1M_CONTEXT`環境変数を追加
- Opus 4.6（高速モード）に完全な1Mコンテキストウィンドウを追加
- VSCode: VS Codeセッションで`/extra-usage`コマンドのサポートを追加
- TaskOutputがクリーンアップ後も最近の行を保持するメモリリークを修正
- CircularBufferでクリアされたアイテムがバッキング配列に保持されるメモリリークを修正
- シェルコマンド実行時にChildProcessとAbortControllerの参照がクリーンアップ後も保持されるメモリリークを修正

## 2.1.49

- MCPのOAuth認証を改善。ステップアップ認証のサポートとディスカバリーキャッシングにより、サーバー接続時の冗長なネットワークリクエストを削減
- 分離されたgitワークツリーでClaudeを起動する`--worktree`（`-w`）フラグを追加
- サブエージェントが一時的なgitワークツリーで作業するための`isolation: "worktree"`をサポート
- バックグラウンドエージェントを強制終了するCtrl+Fキーバインドを追加（2回押しで確認）
- エージェント定義で常にバックグラウンドタスクとして実行する`background: true`をサポート
- プラグインがデフォルト設定用の`settings.json`を同梱可能に
- モデルがリポジトリフォルダを省略した場合に、修正されたパスを提案するようファイル未検出エラーを改善
- バックグラウンドエージェントが実行中でメインスレッドがアイドル状態の際に、Ctrl+CとESCが無視される問題を修正。3秒以内に2回押すとすべてのバックグラウンドエージェントを強制終了
- プロンプトサジェスチョンキャッシュのリグレッションを修正。キャッシュヒット率が低下していた問題を解消
- `plugin enable`と`plugin disable`で`--scope`が指定されていない場合に正しいスコープを自動検出するよう修正。常にユーザースコープをデフォルトにしていた問題を解消
- シンプルモード（`CLAUDE_CODE_SIMPLE`）にBashツールに加えてファイル編集ツールを追加。シンプルモードで直接ファイル編集が可能に
- 安全性チェックがask応答をトリガーした際に権限の提案が表示されるようになり、SDKコンシューマーが権限オプションを表示可能に
- Maxプランから1MコンテキストのSonnet 4.5を削除し、1Mコンテキストを持つ最先端のSonnet 4.6モデルに移行。/modelで切り替えてください
- `/config`経由でトグルした際にverboseモードがthinkingブロック表示を更新しない問題を修正。メモコンパレーターがverbose変更を正しく検出するように
- 長時間セッション中のWASMメモリ無制限増加を修正。tree-sitterパーサーを定期的にリセットすることで解消
- 古いyogaレイアウト参照によるレンダリング問題の可能性を修正
- 非対話モード（`-p`）で起動時の不要なAPI呼び出しをスキップすることでパフォーマンスを改善
- HTTPおよびSSE MCPサーバーの認証失敗をキャッシュすることでパフォーマンスを改善。認証が必要なサーバーへの繰り返し接続試行を回避
- Yoga WASMリニアメモリが縮小されないことによる長時間セッション中のメモリ無制限増加を修正
- SDKモデル情報に`supportsEffort`、`supportedEffortLevels`、`supportsAdaptiveThinking`フィールドを追加。コンシューマーがモデル機能を検出可能に
- セッション中に設定ファイルが変更された際に発火する`ConfigChange`フックイベントを追加。エンタープライズセキュリティ監査と設定変更のオプションブロックが可能に
- MCP認証失敗をキャッシュすることで起動パフォーマンスを改善。冗長な接続試行を回避
- 分析トークンカウント用のHTTP呼び出しを削減することで起動パフォーマンスを改善
- MCPツールのトークンカウントを単一のAPI呼び出しにバッチ処理することで起動パフォーマンスを改善
- `disableAllHooks`設定が管理設定階層を尊重するよう修正。非管理設定がポリシーで設定された管理フックを無効化できなくなりました（#26637）
- `/clear`などのコマンドで始まるセッションに対して`--resume`セッションピッカーが生のXMLタグを表示する問題を修正。セッションIDフォールバックに正しくフォールスルーするように
- パス安全性と作業ディレクトリブロックの権限プロンプトを改善。コンテキストのない素のプロンプトではなく、制限の理由を表示するように

## 2.1.47

- FileWriteToolの行カウントを修正。`trimEnd()`で削除するのではなく、意図的な末尾の空白行を保持するように
- Windowsターミナルのレンダリングバグを修正。表示コードの`os.EOL`（`\r\n`）が原因で、行数がWindowsで常に1と表示される問題を解消
- VS Codeのプランプレビューを改善。Claudeの反復に合わせて自動更新、プランがレビュー準備完了時のみコメント可能に、拒否時もプレビューを開いたままにしてClaudeが修正できるように
- Windowsで`\r\n`改行コードにより、マークダウン出力の太字や色付きテキストが誤った文字にシフトする不具合を修正
- 会話に多数のPDFドキュメントが含まれる場合にコンパクションが失敗する不具合を修正。コンパクションAPIに送信する前に画像と共にドキュメントブロックを削除（anthropics/claude-code#26188）
- APIストリームバッファ、エージェントコンテキスト、スキル状態を使用後に解放することで、長時間セッションのメモリ使用量を改善
- SessionStartフックの実行を遅延させることで起動パフォーマンスを改善。対話開始までの時間を約500ms短縮
- MSYS2またはCygwinシェルを使用する際に、Windowsでbashツール出力が無言で破棄される問題を修正
- `@`ファイルメンションのパフォーマンスを改善。起動時にインデックスを事前ウォームアップし、バックグラウンド更新付きのセッションベースキャッシングを使用することで、ファイル提案がより高速に表示
- エージェントタスク完了後にメッセージ履歴をトリミングすることでメモリ使用量を改善
- 進捗更新でのO(n²)メッセージ蓄積を排除することで、長時間エージェントセッション中のメモリ使用量を改善
- bash権限分類器を修正。返されたマッチ記述が実際の入力ルールに対応することを検証し、幻覚による記述が誤って権限を付与するのを防止
- ゼロinodeを報告するNFS/FUSEファイルシステムでユーザー定義エージェントが1ファイルしか読み込まない問題を修正（anthropics/claude-code#26044）
- 完全修飾プラグイン名ではなく単純名で参照された場合に、プラグインエージェントスキルが無言で読み込みに失敗する問題を修正（anthropics/claude-code#25834）
- 折りたたまれたツール結果の検索パターンを明確にするため引用符で表示
- Windows: CWD追跡の一時ファイルがクリーンアップされず無期限に蓄積する問題を修正（anthropics/claude-code#17600）
- ESCをダブルプレスする代わりに`ctrl+f`ですべてのバックグラウンドエージェントを強制終了。メインスレッドをキャンセルするためにESCを押してもバックグラウンドエージェントは実行を継続し、エージェントのライフサイクルをより細かく制御可能に

## 2.1.49

- MCP OAuth認証を改善し、ステップアップ認証のサポートとディスカバリーキャッシングを追加。サーバー接続時の冗長なネットワークリクエストを削減
- `--worktree`（`-w`）フラグを追加し、分離されたgit worktreeでClaudeを起動可能に
- サブエージェントが`isolation: "worktree"`をサポートし、一時的なgit worktreeで作業可能に
- Ctrl+Fキーバインドを追加し、バックグラウンドエージェントを終了（2回押しで確認）
- エージェント定義で`background: true`をサポートし、常にバックグラウンドタスクとして実行可能に
- プラグインがデフォルト設定用の`settings.json`を同梱可能に
- ファイル未検出エラーを修正し、モデルがリポジトリフォルダを省略した場合に修正パスを提案
- Ctrl+CとESCがバックグラウンドエージェント実行中かつメインスレッドがアイドル状態の時に無視される問題を修正。3秒以内に2回押すとすべてのバックグラウンドエージェントを終了
- プロンプト提案キャッシュの不具合を修正し、キャッシュヒット率の低下を解消
- `plugin enable`と`plugin disable`を修正し、`--scope`未指定時に正しいスコープを自動検出（常にユーザースコープをデフォルトにしていた問題を解消）
- シンプルモード（`CLAUDE_CODE_SIMPLE`）にBashツールに加えてファイル編集ツールを追加し、シンプルモードでの直接ファイル編集が可能に
- 安全性チェックがask応答をトリガーした際に権限提案が表示されるようになり、SDKコンシューマーが権限オプションを表示可能に
- Maxプランから100万コンテキストのSonnet 4.5を削除し、100万コンテキストを持つ最先端のSonnet 4.6モデルを優先。/modelで切り替えてください
- `/config`経由でトグルした際にverboseモードがthinkingブロック表示を更新しない問題を修正 — memoコンパレーターがverbose変更を正しく検出
- 長時間セッション中のWASMメモリの無制限な増加を修正。tree-sitterパーサーを定期的にリセット
- 古いyogaレイアウト参照による潜在的なレンダリング問題を修正
- 非インタラクティブモード（`-p`）のパフォーマンスを改善。起動時の不要なAPI呼び出しをスキップ
- HTTPおよびSSE MCPサーバーの認証失敗をキャッシュすることでパフォーマンスを改善。認証が必要なサーバーへの繰り返し接続試行を回避
- Yoga WASM線形メモリが縮小されないことによる長時間実行セッション中の無制限なメモリ増加を修正
- SDKモデル情報に`supportsEffort`、`supportedEffortLevels`、`supportsAdaptiveThinking`フィールドを追加し、コンシューマーがモデル機能を検出可能に
- `ConfigChange`フックイベントを追加。セッション中に設定ファイルが変更された際に発火し、エンタープライズセキュリティ監査と設定変更のオプションブロックを可能に
- MCP認証失敗をキャッシュすることで起動パフォーマンスを改善し、冗長な接続試行を回避
- 分析用トークンカウントのHTTP呼び出しを削減し、起動パフォーマンスを改善
- MCPツールのトークンカウントを単一のAPI呼び出しにバッチ化し、起動パフォーマンスを改善
- `disableAllHooks`設定を修正し、管理設定の階層を尊重。非管理設定がポリシーで設定された管理フックを無効化できなくなりました（#26637）
- `--resume`セッションピッカーが`/clear`などのコマンドで始まるセッションに対して生のXMLタグを表示する問題を修正。セッションIDフォールバックに正しく移行
- パス安全性と作業ディレクトリブロックの権限プロンプトを改善し、コンテキストのない単なるプロンプトではなく制限の理由を表示

## 2.1.47

- FileWriteToolの行カウントを修正し、`trimEnd()`で削除する代わりに意図的な末尾の空白行を保持
- Windowsターミナルのレンダリングバグを修正。表示コード内の`os.EOL`（`\r\n`）が原因で、行数がWindowsで常に1と表示される問題を解消
- VS Codeプラン プレビューを改善：Claudeの反復に応じて自動更新、プランがレビュー準備完了時のみコメント可能、拒否時もプレビューを開いたままにしてClaudeが修正可能に
- Windowsでマークダウン出力の太字や色付きテキストが`\r\n`改行により誤った文字にシフトするバグを修正
- 会話に多数のPDFドキュメントが含まれる場合の圧縮失敗を修正。圧縮API送信前に画像と共にドキュメントブロックを削除（anthropics/claude-code#26188）
- 長時間実行セッションのメモリ使用量を改善。使用後にAPIストリームバッファ、エージェントコンテキスト、スキル状態を解放
- SessionStartフックの実行を遅延させることで起動パフォーマンスを改善し、インタラクティブまでの時間を約500ms短縮
- MSYS2またはCygwinシェル使用時にWindowsでbashツール出力が黙って破棄される問題を修正
- `@`ファイルメンションのパフォーマンスを改善 - 起動時にインデックスを事前ウォームアップし、バックグラウンド更新を伴うセッションベースのキャッシングを使用することでファイル提案が高速化
- タスク完了後にエージェントタスクメッセージ履歴をトリミングし、メモリ使用量を改善
- 進捗更新でのO(n²)メッセージ蓄積を排除し、長時間のエージェントセッション中のメモリ使用量を改善
- bash権限分類器を修正し、返されたマッチ記述が実際の入力ルールに対応することを検証。幻覚による記述が誤って権限を付与することを防止
- ゼロinodeを報告するNFS/FUSEファイルシステムでユーザー定義エージェントが1ファイルしか読み込まない問題を修正（anthropics/claude-code#26044）
- 完全修飾プラグイン名ではなく単純名で参照された場合にプラグインエージェントスキルが黙って読み込み失敗する問題を修正（anthropics/claude-code#25834）
- 折りたたまれたツール結果の検索パターンを引用符で囲んで表示し、明確化
- Windows：CWD追跡一時ファイルがクリーンアップされず無期限に蓄積する問題を修正（anthropics/claude-code#17600）
- ESCのダブルプレスではなく`ctrl+f`ですべてのバックグラウンドエージェントを終了。ESCを押してメインスレッドをキャンセルしてもバックグラウンドエージェントは実行を継続し、エージェントのライフサイクルをより細かく制御可能に
- 並行エージェントを含むセッションで発生していたAPI 400エラー（「thinking blocksは変更できません」）を修正。インターリーブされたストリーミングコンテンツブロックが適切なメッセージマージを妨げていた問題を解消

## 2.1.49

- `--worktree`（`-w`）フラグを追加し、独立したgit worktreeでClaudeを起動できるようになりました
- サブエージェントが`isolation: "worktree"`をサポートし、一時的なgit worktreeで作業できるようになりました
- Ctrl+Fキーバインドを追加し、バックグラウンドエージェントを終了できるようになりました（2回押しで確認）
- エージェント定義で`background: true`をサポートし、常にバックグラウンドタスクとして実行できるようになりました
- プラグインがデフォルト設定用の`settings.json`を同梱できるようになりました
- モデルがリポジトリフォルダを省略した際に、修正されたパスを提案するようファイル未検出エラーを改善しました
- バックグラウンドエージェントが実行中でメインスレッドがアイドル状態の時に、Ctrl+CとESCが無視される問題を修正しました。3秒以内に2回押すと、すべてのバックグラウンドエージェントが終了します
- プロンプト提案キャッシュのリグレッションを修正し、キャッシュヒット率が低下していた問題を解決しました
- `plugin enable`と`plugin disable`で`--scope`が指定されていない場合に正しいスコープを自動検出するよう修正しました（常にユーザースコープにデフォルト設定されていた問題を解決）
- シンプルモード（`CLAUDE_CODE_SIMPLE`）にBashツールに加えてファイル編集ツールを追加し、シンプルモードで直接ファイル編集ができるようになりました
- 安全性チェックがask応答をトリガーした際に権限提案が表示されるようになり、SDKコンシューマーが権限オプションを表示できるようになりました
- 1Mコンテキストを持つSonnet 4.5がMaxプランから削除され、同じく1Mコンテキストを持つ最先端のSonnet 4.6モデルに置き換えられます。/modelで切り替えてください
- `/config`で切り替えた際にverboseモードが思考ブロック表示を更新しない問題を修正しました — memoコンパレーターがverbose変更を正しく検出するようになりました
- 長時間セッション中のWASMメモリの無制限な増加を修正するため、tree-sitterパーサーを定期的にリセットするようにしました
- 古いyogaレイアウト参照による潜在的なレンダリング問題を修正しました
- 非対話モード（`-p`）での起動時に不要なAPI呼び出しをスキップし、パフォーマンスを改善しました
- 認証失敗をキャッシュすることでHTTPおよびSSE MCPサーバーへの繰り返し接続試行を回避し、パフォーマンスを改善しました
- Yoga WASM線形メモリが縮小されないことによる長時間実行セッション中の無制限なメモリ増加を修正しました
- SDKモデル情報に`supportsEffort`、`supportedEffortLevels`、`supportsAdaptiveThinking`フィールドを追加し、コンシューマーがモデル機能を検出できるようにしました
- セッション中に設定ファイルが変更された際に発火する`ConfigChange`フックイベントを追加し、エンタープライズセキュリティ監査と設定変更の任意ブロックを可能にしました
- MCP認証失敗をキャッシュすることで冗長な接続試行を回避し、起動パフォーマンスを改善しました
- 分析用トークンカウントのHTTP呼び出しを削減し、起動パフォーマンスを改善しました
- MCPツールのトークンカウントを単一のAPI呼び出しにバッチ処理し、起動パフォーマンスを改善しました
- `disableAllHooks`設定が管理設定階層を尊重するよう修正しました — 非管理設定がポリシーで設定された管理フックを無効化できなくなりました（#26637）
- `/clear`などのコマンドで始まるセッションに対して`--resume`セッションピッカーが生のXMLタグを表示する問題を修正しました。セッションIDフォールバックに正しく移行するようになりました
- パス安全性と作業ディレクトリブロックの権限プロンプトを改善し、コンテキストのない単なるプロンプトではなく、制限の理由を表示するようにしました

## 2.1.47

- FileWriteToolの行カウントを修正し、`trimEnd()`で削除するのではなく、意図的な末尾の空白行を保持するようにしました
- 表示コードの`os.EOL`（`\r\n`）によるWindowsターミナルのレンダリングバグを修正しました — 行数がWindowsで常に1と表示される代わりに正しい値を表示するようになりました
- VS Codeプレビュー機能を改善：Claudeの反復に応じて自動更新、プランがレビュー準備完了時のみコメント可能、拒否時もプレビューを開いたままにしてClaudeが修正できるようにしました
- Windowsで`\r\n`改行コードによりmarkdown出力の太字や色付きテキストが間違った文字にシフトするバグを修正しました
- 会話に多数のPDF文書が含まれる場合にコンパクション（圧縮）が失敗する問題を修正し、コンパクションAPIに送信する前に画像と共にドキュメントブロックを削除するようにしました（anthropics/claude-code#26188）
- APIストリームバッファ、エージェントコンテキスト、スキル状態を使用後に解放することで、長時間実行セッションのメモリ使用量を改善しました
- SessionStartフックの実行を遅延させることで起動パフォーマンスを改善し、対話可能になるまでの時間を約500ms短縮しました
- MSYS2またはCygwinシェルを使用している場合にWindowsでbashツール出力が無視される問題を修正しました
- `@`ファイルメンションのパフォーマンスを改善 - 起動時にインデックスを事前ウォームアップし、バックグラウンド更新を伴うセッションベースのキャッシュを使用することで、ファイル提案がより速く表示されるようになりました
- エージェントタスク完了後にメッセージ履歴をトリミングすることで、メモリ使用量を改善しました
- 進捗更新でのO(n²)メッセージ蓄積を排除し、長時間のエージェントセッション中のメモリ使用量を改善しました
- bash権限分類器を修正し、返されたマッチ記述が実際の入力ルールに対応することを検証するようにし、幻覚による記述が誤って権限を付与することを防ぎました
- ゼロinodeを報告するNFS/FUSEファイルシステムでユーザー定義エージェントが1ファイルしか読み込まない問題を修正しました（anthropics/claude-code#26044）
- 完全修飾プラグイン名ではなく単純名で参照された場合にプラグインエージェントスキルが無言で読み込みに失敗する問題を修正しました（anthropics/claude-code#25834）
- 折りたたまれたツール結果の検索パターンが明確性のために引用符で表示されるようになりました
- Windows：CWD追跡の一時ファイルがクリーンアップされず無期限に蓄積される問題を修正しました（anthropics/claude-code#17600）
- ESCをダブルプレスする代わりに`ctrl+f`ですべてのバックグラウンドエージェントを終了できるようになりました。ESCを押してメインスレッドをキャンセルしてもバックグラウンドエージェントは実行を継続し、エージェントのライフサイクルをより細かく制御できるようになりました
- 並行エージェントを含むセッションで発生していたAPI 400エラー（「thinking blocksは変更できません」）を修正しました。インターリーブされたストリーミングコンテンツブロックが適切なメッセージマージを妨げていたことが原因でした
- チームメイトナビゲーションを簡素化し、Shift+UpとShift+Downの両方ではなく、Shift+Down（ラップあり）のみを使用するようにしました
- 単一のファイル書き込み/編集エラーが他のすべての並列ファイル書き込み/編集操作を中止する問題を修正しました。独立したファイル変更は、兄弟操作が失敗しても完了するようになりました
- StopおよびSubagentStopフック入力に`last_assistant_message`フィールドを追加し、トランスクリプトファイルを解析せずに最終アシスタント応答テキストにアクセスできるようにしました
- `/rename`で設定したカスタムセッションタイトルが会話再開後に失われる問題を修正しました（anthropics/claude-code#23610）
- 狭いターミナルで折りたたまれた読み取り/検索ヒントテキストがオーバーフローする問題を、先頭から切り詰めることで修正しました
- バックスラッシュ-改行継続行を含むbashコマンド（例：`\`で複数行に分割された長いコマンド）が偽の空引数を生成し、コマンド実行を破壊する可能性がある問題を修正しました
- 多数のユーザースキルがインストールされている場合に、組み込みスラッシュコマンド（`/help`、`/model`、`/compact`など）がオートコンプリートドロップダウンから非表示になる問題を修正しました（anthropics/claude-code#22020）
- 遅延読み込み後にMCPサーバーがMCP管理ダイアログに表示されない問題を修正しました
- `/clear`コマンド後にセッション名がステータスバーに残る問題を修正しました（anthropics/claude-code#26082）
- SKILL.mdフロントマターのスキルの`name`または`description`が単純な数値（例：`name: 3000`）の場合にクラッシュする問題を修正しました — 値が適切に文字列に変換されるようになりました（anthropics/claude-code#25837）
- 最初のメッセージが16KBを超えるか配列形式のコンテンツを使用している場合に、/resumeが無言でセッションをドロップする問題を修正しました（anthropics/claude-code#25721）
- 設定可能な複数行入力用の`chat:newline`キーバインドアクションを追加しました（anthropics/claude-code#26075）
- ステータスラインJSONの`workspace`セクションに`added_dirs`を追加し、`/add-dir`で追加されたディレクトリを外部スクリプトに公開しました（anthropics/claude-code#26096）
- `claude doctor`がmiseおよびasdf管理のインストールをネイティブインストールとして誤分類する問題を修正しました（anthropics/claude-code#26033）
- サンドボックス化されたコマンドでzsh heredocが「読み取り専用ファイルシステム」エラーで失敗する問題を修正しました（anthropics/claude-code#25990）
- エージェント進捗インジケーターが膨らんだツール使用カウントを表示する問題を修正しました（anthropics/claude-code#26023）
- WindowsがBMP形式で画像をコピーするWSL2システムで画像の貼り付けが機能しない問題を修正しました（anthropics/claude-code#25935）
- バックグラウンドエージェントの結果がエージェントの最終回答ではなく生のトランスクリプトデータを返す問題を修正しました（anthropics/claude-code#26012）
- Warpターミナルがネイティブでサポートしているにもかかわらず、Shift+Enterセットアップを誤って促す問題を修正しました（anthropics/claude-code#25957）
- CJK全角文字がTUIのタイムスタンプとレイアウト要素の位置ずれを引き起こす問題を修正しました（anthropics/claude-code#26084）
- チームチームメイトを生成する際に`.claude/agents/*.md`のカスタムエージェント`model`フィールドが無視される問題を修正しました（anthropics/claude-code#26064）
- コンテキストコンパクション後にプランモードが失われ、モデルがプランニングモードから実装モードに切り替わる問題を修正しました（anthropics/claude-code#26061）
- settings.jsonの`alwaysThinkingEnabled: true`がBedrockおよびVertexプロバイダーで思考モードを有効にしない問題を修正しました（anthropics/claude-code#26074）
- ヘッドレス/SDKモードで`tool_decision` OTelテレメトリーイベントが発行されない問題を修正しました（anthropics/claude-code#26059）
- コンテキストコンパクション後にセッション名が失われる問題を修正しました — 名前変更されたセッションがコンパクションを通じてカスタムタイトルを保持するようになりました（anthropics/claude-code#26121）
- セッション検出を高速化するため、再開ピッカーの初期セッション数を10から50に増やしました（anthropics/claude-code#26123）
- Windows：ドライブレターの大文字小文字が異なる場合のworktreeセッションマッチングを修正しました（anthropics/claude-code#26123）
- 最初のメッセージが16KBを超えるセッションを`/resume <session-id>`が見つけられない問題を修正しました（anthropics/claude-code#25920）
- 複数行bashコマンドで「常に許可」を選択すると、設定を破損する無効な権限パターンが作成される問題を修正しました（anthropics/claude-code#25909）

## 2.1.47

- FileWriteToolの行カウント処理を修正し、`trimEnd()`で削除していた意図的な末尾の空行を保持するようにしました。
- Windowsのターミナル表示バグを修正しました。表示コード内の`os.EOL`（`\r\n`）が原因で、行数が常に1と表示されていた問題を解決し、正しい値を表示するようにしました。
- VS Codeのプレビュー機能を改善：Claudeの反復処理に合わせて自動更新され、プランがレビュー可能になった時点でコメントが有効化されます。また、却下時もプレビューを開いたままにすることで、Claudeが修正できるようにしました。
- Windowsで`\r\n`の改行コードが原因で、Markdown出力の太字や色付きテキストが誤った文字位置にずれる問題を修正しました。
- 会話に多数のPDF文書が含まれている場合に圧縮が失敗する問題を修正しました。圧縮API送信前に画像と共にドキュメントブロックを削除するようにしました（anthropics/claude-code#26188）
- 長時間実行されるセッションでのメモリ使用量を改善しました。使用後にAPIストリームバッファ、エージェントコンテキスト、スキル状態を解放するようにしました。
- 起動パフォーマンスを改善しました。SessionStartフックの実行を遅延させることで、操作可能になるまでの時間を約500ms短縮しました。
- WindowsでMSYS2またはCygwinシェルを使用している場合に、bashツールの出力が黙って破棄される問題を修正しました。
- `@`によるファイルメンション機能のパフォーマンスを改善しました。起動時にインデックスを事前ウォームアップし、セッションベースのキャッシュとバックグラウンド更新を使用することで、ファイル候補がより速く表示されるようになりました。
- エージェントタスク完了後にメッセージ履歴をトリミングすることで、メモリ使用量を改善しました。
- 長時間のエージェントセッション中のメモリ使用量を改善しました。進捗更新でのO(n²)のメッセージ蓄積を排除しました。
- bash権限分類器を修正し、返されたマッチ説明が実際の入力ルールに対応していることを検証するようにしました。これにより、幻覚による説明が誤って権限を付与することを防ぎます。
- ゼロinodeを報告するNFS/FUSEファイルシステムで、ユーザー定義エージェントが1つのファイルしか読み込まない問題を修正しました（anthropics/claude-code#26044）
- 完全修飾プラグイン名ではなく単純な名前で参照された場合に、プラグインエージェントスキルが黙って読み込みに失敗する問題を修正しました（anthropics/claude-code#25834）
- 折りたたまれたツール結果内の検索パターンを、明確にするため引用符で囲んで表示するようにしました。
- Windows：CWD追跡用の一時ファイルがクリーンアップされず、無期限に蓄積される問題を修正しました（anthropics/claude-code#17600）
- ESCキーの二度押しではなく、`ctrl+f`ですべてのバックグラウンドエージェントを終了するようにしました。メインスレッドをキャンセルするためにESCキーを押してもバックグラウンドエージェントは実行を継続し、エージェントのライフサイクルをより細かく制御できるようになりました。
- 同時実行エージェントを含むセッションで発生していたAPI 400エラー（「thinking blocksは変更できません」）を修正しました。インターリーブされたストリーミングコンテンツブロックが適切なメッセージマージを妨げていたことが原因でした。
- チームメイトのナビゲーションを簡素化し、Shift+UpとShift+Downの両方ではなく、Shift+Down（ラップあり）のみを使用するようにしました。
- 単一のファイル書き込み/編集エラーが、他のすべての並列ファイル書き込み/編集操作を中止させる問題を修正しました。独立したファイル変更は、兄弟操作が失敗しても完了するようになりました。
- StopおよびSubagentStopフック入力に`last_assistant_message`フィールドを追加しました。これにより、トランスクリプトファイルを解析せずに最終的なアシスタント応答テキストにアクセスできます。
- `/rename`で設定したカスタムセッションタイトルが、会話再開後に失われる問題を修正しました（anthropics/claude-code#23610）
- 狭いターミナルで折りたたまれた読み取り/検索のヒントテキストがオーバーフローする問題を、先頭から切り詰めることで修正しました。
- バックスラッシュ改行継続行を含むbashコマンド（例：`\`で複数行に分割された長いコマンド）が、偽の空引数を生成し、コマンド実行を破壊する可能性がある問題を修正しました。
- 多数のユーザースキルがインストールされている場合に、組み込みスラッシュコマンド（`/help`、`/model`、`/compact`など）がオートコンプリートドロップダウンから隠れる問題を修正しました（anthropics/claude-code#22020）
- 遅延読み込み後にMCPサーバーがMCP管理ダイアログに表示されない問題を修正しました。
- `/clear`コマンド後にステータスバーにセッション名が残る問題を修正しました（anthropics/claude-code#26082）
- SKILL.mdのフロントマターで`name`や`description`が単純な数値（例：`name: 3000`）の場合にクラッシュする問題を修正しました。値を適切に文字列に変換するようにしました（anthropics/claude-code#25837）
- 最初のメッセージが16KBを超えるか配列形式のコンテンツを使用している場合に、/resumeがセッションを黙って削除する問題を修正しました（anthropics/claude-code#25721）
- 複数行入力を設定可能にする`chat:newline`キーバインディングアクションを追加しました（anthropics/claude-code#26075）
- ステータスラインJSONの`workspace`セクションに`added_dirs`を追加し、`/add-dir`で追加されたディレクトリを外部スクリプトに公開するようにしました（anthropics/claude-code#26096）
- `claude doctor`がmiseおよびasdf管理のインストールをネイティブインストールとして誤分類する問題を修正しました（anthropics/claude-code#26033）
- サンドボックス化されたコマンドでzshヒアドキュメントが「読み取り専用ファイルシステム」エラーで失敗する問題を修正しました（anthropics/claude-code#25990）
- エージェント進捗インジケーターが膨らんだツール使用回数を表示する問題を修正しました（anthropics/claude-code#26023）
- WindowsがBMP形式で画像をコピーするWSL2システムで画像の貼り付けが機能しない問題を修正しました（anthropics/claude-code#25935）
- バックグラウンドエージェントの結果が、エージェントの最終回答ではなく生のトランスクリプトデータを返す問題を修正しました（anthropics/claude-code#26012）
- Warpターミナルがネイティブでサポートしているにもかかわらず、Shift+Enterの設定を誤って促す問題を修正しました（anthropics/claude-code#25957）
- CJKワイド文字がTUIのタイムスタンプやレイアウト要素の位置ずれを引き起こす問題を修正しました（anthropics/claude-code#26084）
- チームメイトを生成する際に、`.claude/agents/*.md`のカスタムエージェント`model`フィールドが無視される問題を修正しました（anthropics/claude-code#26064）
- コンテキスト圧縮後にプランモードが失われ、モデルが計画モードから実装モードに切り替わる問題を修正しました（anthropics/claude-code#26061）
- settings.jsonの`alwaysThinkingEnabled: true`が、BedrockおよびVertexプロバイダーで思考モードを有効にしない問題を修正しました（anthropics/claude-code#26074）
- ヘッドレス/SDKモードで`tool_decision` OTelテレメトリイベントが発行されない問題を修正しました（anthropics/claude-code#26059）
- コンテキスト圧縮後にセッション名が失われる問題を修正しました。名前変更されたセッションは、圧縮を経てもカスタムタイトルを保持するようになりました（anthropics/claude-code#26121）
- セッション検出を高速化するため、再開ピッカーの初期セッション数を10から50に増やしました（anthropics/claude-code#26123）
- Windows：ドライブレターの大文字小文字が異なる場合のワークツリーセッションマッチングを修正しました（anthropics/claude-code#26123）
- 最初のメッセージが16KBを超えるセッションで`/resume <session-id>`が失敗する問題を修正しました（anthropics/claude-code#25920）
- 複数行bashコマンドで「常に許可」を選択すると、設定を破損させる無効な権限パターンが作成される問題を修正しました（anthropics/claude-code#25909）
- SKILL.mdのフロントマターでスキルの`argument-hint`がYAMLシーケンス構文（例：`[topic: foo | bar]`）を使用している場合にReactクラッシュ（エラー#31）が発生する問題を修正しました。値を適切に文字列に変換するようにしました（anthropics/claude-code#25826）
- Web検索を使用したセッションで`/fork`を使用するとクラッシュする問題を修正しました。トランスクリプトのデシリアライゼーションによる検索結果のnullエントリを適切に処理するようにしました（anthropics/claude-code#25811）
- macOSで読み取り専用gitコマンドがFSEventsファイルウォッチャーループをトリガーする問題を、--no-optional-locksフラグを追加することで修正しました（anthropics/claude-code#25750）
- gitワークツリーから実行した場合にカスタムエージェントとスキルが検出されない問題を修正しました。メインリポジトリのプロジェクトレベル`.claude/agents/`と`.claude/skills/`が含まれるようになりました（anthropics/claude-code#25816）
- `claude doctor`や`claude plugin validate`などの非対話型サブコマンドが、ネストされたClaudeセッション内でブロックされる問題を修正しました（anthropics/claude-code#25803）
- Windows：パス間でドライブレターの大文字小文字が異なる場合に、同じCLAUDE.mdファイルが2回読み込まれる問題を修正しました（anthropics/claude-code#25756）
- Markdown内のインラインコードスパンがbashコマンドとして誤って解析される問題を修正しました（anthropics/claude-code#25792）
- チームメイトのスピナーが設定のカスタムspinnerVerbsを尊重しない問題を修正しました（anthropics/claude-code#25748）
- コマンドが自身の作業ディレクトリを削除した後、シェルコマンドが永続的に失敗する問題を修正しました（anthropics/claude-code#26136）
- Windowsでフック（PreToolUse、PostToolUse）がcmd.exeではなくGit Bashを使用することで、黙って実行に失敗する問題を修正しました（anthropics/claude-code#25981）
- LSPの`findReferences`やその他の位置ベースの操作が、gitignoreされたファイル（例：`node_modules/`、`venv/`）から結果を返す問題を修正しました（anthropics/claude-code#26051）
- ホームディレクトリの乱雑さを軽減するため、設定バックアップファイルをホームディレクトリのルートから`~/.claude/backups/`に移動しました（anthropics/claude-code#26130）
- 最初のプロンプトが大きい（>16KB）セッションが/resumeリストから消える問題を修正しました（anthropics/claude-code#26140）
- 二重アンダースコアプレフィックスを持つシェル関数（例：`__git_ps1`）がシェルセッション間で保持されない問題を修正しました（anthropics/claude-code#25824）
- トークンを受信する前にスピナーが「0 tokens」カウンターを表示する問題を修正しました（anthropics/claude-code#26105）
- VSCode：AskUserQuestionダイアログが開いている間、会話メッセージが薄く表示される問題を修正しました（anthropics/claude-code#26078）
- gitワークツリーでバックグラウンドタスクが失敗する問題を修正しました。リモートURL解決がメインリポジトリ設定ではなくワークツリー固有のgitdirから読み取っていたことが原因でした（anthropics/claude-code#26065）
- Windows/Git Bashターミナルで右Altキーが入力フィールドに`[25~`エスケープシーケンスの残骸を残す問題を修正しました（anthropics/claude-code#25943）
- `/rename`コマンドがデフォルトでターミナルタブのタイトルを更新するようになりました（anthropics/claude-code#25789）
- Editツールが編集時にUnicodeカーリー引用符（\u201c\u201d \u2018\u2019）をストレート引用符に置き換えて黙って破損させる問題を修正しました（anthropics/claude-code#26141）
- リンクテキストが複数のターミナル行にまたがる場合に、OSC 8ハイパーリンクが最初の行でのみクリック可能になる問題を修正しました。

## 2.1.46

- macOSでターミナル切断後に孤立したCCプロセスが残る問題を修正しました。
- Claude Code内でclaude.ai MCPコネクタを使用できるようになりました。

## 2.1.45

- Claude Sonnet 4.6のサポートを追加しました。
- `--add-dir`ディレクトリから`enabledPlugins`と`extraKnownMarketplaces`を読み取るサポートを追加しました。
- スピナーのヒントをカスタマイズできる`spinnerTipsOverride`設定を追加しました。カスタムヒント文字列の配列で`tips`を設定し、オプションで`excludeDefault: true`を設定することで、組み込みのヒントではなくカスタムヒントのみを表示できます。
- SDKに`SDKRateLimitInfo`と`SDKRateLimitEvent`型を追加し、利用率、リセット時刻、超過情報を含むレート制限ステータス更新を受信できるようにしました。
- Bedrock、Vertex、FoundryでAgent Teamsのチームメイトが失敗する問題を修正しました。APIプロバイダー環境変数をtmux生成プロセスに伝播するようにしました（anthropics/claude-code#23561）
- macOSで一時ファイルを書き込む際にサンドボックスで「操作が許可されていません」エラーが発生する問題を、ユーザーごとの正しい一時ディレクトリを使用することで修正しました（anthropics/claude-code#21654）
- Taskツール（バックグラウンドエージェント）が完了時に`ReferenceError`でクラッシュする問題を修正しました（anthropics/claude-code#22087）
- 入力に画像が貼り付けられている場合に、Enterキーでオートコンプリート候補が受け入れられない問題を修正しました。
- サブエージェントによって呼び出されたスキルが、圧縮後にメインセッションコンテキストに誤って表示される問題を修正しました。
- 起動のたびに過剰な`.claude.json.backup`ファイルが蓄積される問題を修正しました。
- プラグインが提供するコマンド、エージェント、フックがインストール直後に利用可能になり、再起動が不要になりました。
- セッション履歴の統計キャッシュ用の早期読み込みを削除することで、起動パフォーマンスを改善しました。
- 大量の出力を生成するシェルコマンドのメモリ使用量を改善しました。RSSがコマンド出力サイズに応じて無制限に増加しなくなりました。
- 折りたたまれた読み取り/検索グループを改善し、アクティブな間はサマリー行の下に現在処理中のファイルまたは検索パターンを表示するようにしました。
- [VSCode] 権限の保存先選択（プロジェクト/ユーザー/セッション）がセッション間で保持されるようになりました。

## 2.1.44

- 深くネストされたディレクトリパスでのENAMETOOLONGエラーを修正しました。
- 認証更新エラーを修正しました。

## 2.1.43

- 3分のタイムアウトを追加することで、AWS認証更新が無期限にハングする問題を修正しました。
- `.claude/agents/`ディレクトリ内の非エージェントMarkdownファイルに対する偽の警告を修正しました。
- Vertex/Bedrockでstructured-outputsベータヘッダーが無条件に送信される問題を修正しました。

## 2.1.42

- Zodスキーマ構築を遅延させることで、起動パフォーマンスを改善しました。
- システムプロンプトから日付を移動することで、プロンプトキャッシュのヒット率を改善しました。
- 対象ユーザーに対してOpus 4.6の取り組みに関する1回限りの告知を追加しました。
- /resumeが中断メッセージをセッションタイトルとして表示する問題を修正しました。
- 画像サイズ制限エラーで/compactを提案するようにしました。

## 2.1.41

- 別のClaude Codeセッション内でClaude Codeを起動することに対するガードを追加しました。
- Agent TeamsがBedrock、Vertex、Foundryの顧客に対して誤ったモデル識別子を使用する問題を修正しました。
- ストリーミング中にMCPツールが画像コンテンツを返す場合のクラッシュを修正しました。
- /resumeセッションプレビューが、読みやすいコマンド名ではなく生のXMLタグを表示する問題を修正しました。
- Bedrock/Vertex/Foundryユーザー向けのモデルエラーメッセージを、フォールバック提案付きで改善しました。
- プラグインブラウズで、すでにインストールされているプラグインに対して誤解を招く「スペースでトグル」ヒントが表示される問題を修正しました。
- フックブロッキングエラー（終了コード2）がstderrをユーザーに表示しない問題を修正しました。
- 高速モードの可視性のため、OTelイベントとトレーススパンに`speed`属性を追加しました。
- `claude auth login`、`claude auth status`、`claude auth logout` CLIサブコマンドを追加しました。
- Windows ARM64（win32-arm64）ネイティブバイナリサポートを追加しました。

## 2.1.45

- Claude Sonnet 4.6のサポートを追加
- `--add-dir`ディレクトリから`enabledPlugins`と`extraKnownMarketplaces`を読み取る機能を追加
- スピナーのヒントをカスタマイズできる`spinnerTipsOverride`設定を追加 — `tips`にカスタムヒント文字列の配列を設定し、オプションで`excludeDefault: true`を設定することで、組み込みのヒントの代わりにカスタムヒントのみを表示可能
- SDKに`SDKRateLimitInfo`と`SDKRateLimitEvent`型を追加し、利用状況、リセット時間、超過情報を含むレート制限ステータスの更新を受信可能に
- APIプロバイダーの環境変数をtmuxで生成されたプロセスに伝播することで、Bedrock、Vertex、FoundryでAgent Teamsのチームメイトが失敗する問題を修正 (anthropics/claude-code#23561)
- macOSでユーザーごとの正しい一時ディレクトリを使用することで、一時ファイル書き込み時のサンドボックス「operation not permitted」エラーを修正 (anthropics/claude-code#21654)
- Taskツール（バックグラウンドエージェント）が完了時に`ReferenceError`でクラッシュする問題を修正 (anthropics/claude-code#22087)
- 入力欄に画像が貼り付けられている場合にEnterキーでオートコンプリート候補が受け入れられない問題を修正
- サブエージェントによって呼び出されたスキルが、圧縮後にメインセッションのコンテキストに誤って表示される問題を修正
- 起動のたびに`.claude.json.backup`ファイルが過度に蓄積される問題を修正
- プラグインが提供するコマンド、エージェント、フックがインストール直後に再起動なしで利用可能になるよう改善
- 統計キャッシュのためのセッション履歴の先行読み込みを削除し、起動パフォーマンスを改善
- 大量の出力を生成するシェルコマンドのメモリ使用量を改善 — コマンド出力サイズに応じてRSSが無制限に増加しなくなりました
- 折りたたまれた読み取り/検索グループが、アクティブな間、サマリー行の下に処理中の現在のファイルまたは検索パターンを表示するよう改善
- [VSCode] パーミッション保存先の選択（プロジェクト/ユーザー/セッション）がセッション間で保持されるよう改善

## 2.1.44

- 深くネストされたディレクトリパスでのENAMETOOLONGエラーを修正
- 認証更新エラーを修正

## 2.1.43

- 3分のタイムアウトを追加することで、AWS認証更新が無期限にハングする問題を修正
- `.claude/agents/`ディレクトリ内の非エージェントmarkdownファイルに対する不要な警告を修正
- Vertex/Bedrockでstructured-outputsベータヘッダーが無条件に送信される問題を修正

## 2.1.42

- Zodスキーマの構築を遅延させることで起動パフォーマンスを改善
- システムプロンプトから日付を移動することでプロンプトキャッシュのヒット率を改善
- 対象ユーザー向けにOpus 4.6の取り組みに関する1回限りの案内を追加
- /resumeで中断メッセージがセッションタイトルとして表示される問題を修正
- 画像サイズ制限エラーで/compactを提案するよう修正

## 2.1.41

- 別のClaude Codeセッション内でClaude Codeを起動することに対するガードを追加
- Agent TeamsがBedrock、Vertex、Foundryの顧客に対して誤ったモデル識別子を使用する問題を修正
- MCPツールがストリーミング中に画像コンテンツを返す際のクラッシュを修正
- /resumeのセッションプレビューで、読みやすいコマンド名の代わりに生のXMLタグが表示される問題を修正
- Bedrock/Vertex/Foundryユーザー向けのモデルエラーメッセージをフォールバック提案付きで改善
- プラグインブラウズで、すでにインストール済みのプラグインに対して誤解を招く「Space to Toggle」ヒントが表示される問題を修正
- フックブロッキングエラー（終了コード2）でstderrがユーザーに表示されない問題を修正
- 高速モードの可視性のため、OTelイベントとトレーススパンに`speed`属性を追加
- `claude auth login`、`claude auth status`、`claude auth logout`のCLIサブコマンドを追加
- Windows ARM64（win32-arm64）ネイティブバイナリサポートを追加
- `/rename`を引数なしで呼び出した際に、会話コンテキストからセッション名を自動生成するよう改善
- 狭い端末レイアウトでのプロンプトフッターを改善
- アンカーフラグメント付きの@メンション（例：`@README.md#installation`）でファイル解決が失敗する問題を修正
- FileReadToolがFIFO、`/dev/stdin`、大きなファイルでプロセスをブロックする問題を修正
- ストリーミングAgent SDKモードでバックグラウンドタスク通知が配信されない問題を修正
- 分類ルール入力で各キーストロークごとにカーソルが末尾にジャンプする問題を修正
- 生URLのmarkdownリンク表示テキストが削除される問題を修正
- 自動圧縮失敗エラー通知がユーザーに表示される問題を修正
- サブエージェントの経過時間表示にパーミッション待機時間が含まれる問題を修正
- プランモード中にプロアクティブティックが発火する問題を修正
- ディスク上の設定変更時に古いパーミッションルールをクリアするよう修正
- フックブロッキングエラーでstderrの内容がUIに表示される問題を修正

## 2.1.39

- ターミナルのレンダリングパフォーマンスを改善
- 致命的エラーが表示されずに飲み込まれる問題を修正
- セッション終了後にプロセスがハングする問題を修正

## 2.1.44

- 深くネストされたディレクトリパスでのENAMETOOLONGエラーを修正
- 認証更新エラーを修正

## 2.1.43

- AWS認証更新が無期限にハングする問題を3分のタイムアウトを追加して修正
- `.claude/agents/`ディレクトリ内の非エージェントmarkdownファイルに対する誤った警告を修正
- Vertex/Bedrockで構造化出力のベータヘッダーが無条件に送信される問題を修正

## 2.1.42

- Zodスキーマの構築を遅延させることで起動パフォーマンスを改善
- システムプロンプトから日付を移動することでプロンプトキャッシュのヒット率を改善
- 対象ユーザー向けにOpus 4.6の一回限りの注意喚起を追加
- /resumeで中断メッセージがセッションタイトルとして表示される問題を修正
- 画像サイズ制限エラーで/compactを提案するように修正

## 2.1.41

- 別のClaude Codeセッション内でClaude Codeを起動することを防ぐガードを追加
- Agent TeamsがBedrock、Vertex、Foundryの顧客に対して誤ったモデル識別子を使用する問題を修正
- MCPツールがストリーミング中に画像コンテンツを返した際のクラッシュを修正
- /resumeのセッションプレビューで、読みやすいコマンド名ではなく生のXMLタグが表示される問題を修正
- Bedrock/Vertex/Foundryユーザー向けのモデルエラーメッセージを改善し、フォールバック提案を追加
- プラグインブラウズで、すでにインストール済みのプラグインに対して誤解を招く「Space to Toggle」ヒントが表示される問題を修正
- フックブロッキングエラー(終了コード2)でstderrがユーザーに表示されない問題を修正
- 高速モードの可視性のため、OTelイベントとトレーススパンに`speed`属性を追加
- `claude auth login`、`claude auth status`、`claude auth logout`のCLIサブコマンドを追加
- Windows ARM64 (win32-arm64)ネイティブバイナリサポートを追加
- `/rename`を改善し、引数なしで呼び出された場合に会話コンテキストからセッション名を自動生成
- プロンプトフッターの狭い端末レイアウトを改善
- アンカーフラグメント付きの@メンション(例：`@README.md#installation`)でファイル解決が失敗する問題を修正
- FileReadToolがFIFO、`/dev/stdin`、大きなファイルでプロセスをブロックする問題を修正
- ストリーミングAgent SDKモードでバックグラウンドタスク通知が配信されない問題を修正
- 分類ルール入力で各キーストロークごとにカーソルが末尾にジャンプする問題を修正
- 生URLに対してmarkdownリンクの表示テキストが削除される問題を修正
- 自動コンパクト失敗エラー通知がユーザーに表示される問題を修正
- サブエージェントの経過時間表示にパーミッション待機時間が含まれる問題を修正
- プランモード中にプロアクティブティックが発火する問題を修正
- ディスク上の設定が変更された際に古いパーミッションルールをクリアするように修正
- フックブロッキングエラーでstderrの内容がUIに表示される問題を修正

## 2.1.39

- ターミナルレンダリングパフォーマンスを改善
- 致命的エラーが表示されずに握りつぶされる問題を修正
- セッション終了後にプロセスがハングする問題を修正
- ターミナル画面境界で文字が失われる問題を修正

## 2.1.44

- 認証更新エラーを修正

## 2.1.43

- AWS認証更新が無期限にハングする問題を3分のタイムアウトを追加して修正
- `.claude/agents/`ディレクトリ内の非エージェントmarkdownファイルに対する誤った警告を修正
- Vertex/Bedrockで構造化出力のベータヘッダーが無条件に送信される問題を修正

## 2.1.42

- Zodスキーマの構築を遅延させることで起動パフォーマンスを改善
- システムプロンプトから日付を移動させることでプロンプトキャッシュのヒット率を改善
- 対象ユーザー向けにOpus 4.6の取り組みに関する一度限りの通知を追加
- `/resume`で中断メッセージがセッションタイトルとして表示される問題を修正
- 画像サイズ制限エラーで`/compact`を提案するように修正

## 2.1.41

- 別のClaude Codeセッション内でClaude Codeを起動することを防ぐガードを追加
- Agent TeamsがBedrock、Vertex、Foundry利用者に対して誤ったモデル識別子を使用する問題を修正
- ストリーミング中にMCPツールが画像コンテンツを返す際のクラッシュを修正
- `/resume`のセッションプレビューで読みやすいコマンド名の代わりに生のXMLタグが表示される問題を修正
- Bedrock/Vertex/Foundry利用者向けにフォールバック提案を含むモデルエラーメッセージを改善
- プラグインブラウズで既にインストール済みのプラグインに対して誤解を招く「Space to Toggle」ヒントが表示される問題を修正
- フックブロッキングエラー(終了コード2)でstderrがユーザーに表示されない問題を修正
- 高速モードの可視性のためにOTelイベントとトレーススパンに`speed`属性を追加
- `claude auth login`、`claude auth status`、`claude auth logout`のCLIサブコマンドを追加
- Windows ARM64(win32-arm64)ネイティブバイナリサポートを追加
- `/rename`を改善し、引数なしで呼び出された場合に会話コンテキストからセッション名を自動生成するように変更
- 狭い端末レイアウトでのプロンプトフッターを改善
- アンカーフラグメント付きの@メンション(例：`@README.md#installation`)でファイル解決が失敗する問題を修正
- FileReadToolがFIFO、`/dev/stdin`、大きなファイルでプロセスをブロックする問題を修正
- ストリーミングAgent SDKモードでバックグラウンドタスク通知が配信されない問題を修正
- 分類ルール入力で各キーストロークごとにカーソルが末尾にジャンプする問題を修正
- 生URLに対してmarkdownリンクの表示テキストが削除される問題を修正
- 自動コンパクト失敗エラー通知がユーザーに表示される問題を修正
- サブエージェントの経過時間表示にパーミッション待機時間が含まれる問題を修正
- プランモード中にプロアクティブティックが発火する問題を修正
- ディスク上の設定変更時に古いパーミッションルールをクリアするように修正
- フックブロッキングエラーでstderrの内容がUIに表示される問題を修正

## 2.1.39

- 端末レンダリングパフォーマンスを改善
- 致命的エラーが表示されずに飲み込まれる問題を修正
- セッション終了後にプロセスがハングする問題を修正
- 端末画面境界での文字欠落を修正
- 詳細トランスクリプトビューでの空白行を修正

## 2.1.38

- 2.1.37で発生したVS Code端末のスクロールトップ機能の不具合を修正
- Tabキーがオートコンプリートの代わりにスラッシュコマンドをキューイングする問題を修正
- 環境変数ラッパーを使用するコマンドのbashパーミッションマッチングを修正
- ストリーミングを使用しない場合にツール使用間のテキストが消える問題を修正
- VS Code拡張機能で再開時に重複セッションが作成される問題を修正
- コマンドスマグリングを防ぐためにヒアドキュメント区切り文字の解析を改善

## 2.1.42

- Zodスキーマの構築を遅延させることで起動パフォーマンスを改善
- システムプロンプトから日付を移動することでプロンプトキャッシュのヒット率を向上
- 対象ユーザー向けにOpus 4.6の一回限りの利用案内を追加
- `/resume`で中断メッセージがセッションタイトルとして表示される問題を修正
- 画像サイズ制限エラーで`/compact`の使用を提案するように修正

## 2.1.41

- Claude Codeセッション内で別のClaude Codeセッションが起動されるのを防ぐガードを追加
- Agent TeamsがBedrock、Vertex、Foundryユーザーに対して誤ったモデル識別子を使用していた問題を修正
- MCPツールがストリーミング中に画像コンテンツを返した際のクラッシュを修正
- `/resume`のセッションプレビューで、読みやすいコマンド名の代わりに生のXMLタグが表示される問題を修正
- Bedrock/Vertex/Foundryユーザー向けのモデルエラーメッセージを改善し、フォールバック提案を追加
- プラグインブラウズで、すでにインストール済みのプラグインに対して誤解を招く「Space to Toggle」ヒントが表示される問題を修正
- フックブロッキングエラー(終了コード2)でstderrがユーザーに表示されない問題を修正
- 高速モードの可視性のため、OTelイベントとトレーススパンに`speed`属性を追加
- `claude auth login`、`claude auth status`、`claude auth logout`のCLIサブコマンドを追加
- Windows ARM64(win32-arm64)ネイティブバイナリサポートを追加
- `/rename`を改善し、引数なしで呼び出された場合に会話コンテキストからセッション名を自動生成
- プロンプトフッターの狭い端末レイアウトを改善
- アンカーフラグメント付きの@メンション(例：`@README.md#installation`)でファイル解決が失敗する問題を修正
- FileReadToolがFIFO、`/dev/stdin`、大容量ファイルでプロセスをブロックする問題を修正
- ストリーミングAgent SDKモードでバックグラウンドタスク通知が配信されない問題を修正
- 分類ルール入力で各キーストロークごとにカーソルが末尾にジャンプする問題を修正
- Markdownリンクの表示テキストが生URLに対してドロップされる問題を修正
- 自動コンパクト失敗のエラー通知がユーザーに表示される問題を修正
- サブエージェントの経過時間表示にパーミッション待機時間が含まれる問題を修正
- プランモード中にプロアクティブティックが発火する問題を修正
- ディスク上の設定変更時に古いパーミッションルールをクリアするように修正
- フックブロッキングエラーでstderrの内容がUIに表示される問題を修正

## 2.1.39

- ターミナルのレンダリングパフォーマンスを改善
- 致命的エラーが表示されずに飲み込まれる問題を修正
- セッション終了後にプロセスがハングする問題を修正
- ターミナル画面境界での文字欠落を修正
- 詳細トランスクリプトビューでの空白行を修正

## 2.1.38

- 2.1.37で発生したVS Codeターミナルのスクロールトップへの移動の不具合を修正
- Tabキーでスラッシュコマンドがキューイングされ、オートコンプリートされない問題を修正
- 環境変数ラッパーを使用するコマンドのbashパーミッションマッチングを修正
- ストリーミングを使用しない場合にツール使用間のテキストが消える問題を修正
- VS Code拡張機能で再開時に重複セッションが作成される問題を修正
- コマンドスマグリングを防ぐためにヒアドキュメント区切り文字の解析を改善
- サンドボックスモードで`.claude/skills`ディレクトリへの書き込みをブロック

## 2.1.37

- `/extra-usage`有効化後に`/fast`がすぐに利用できない問題を修正

## 2.1.36

# チェンジログ

## 2.1.41

- 別のClaude Codeセッション内でClaude Codeを起動することを防ぐガードを追加
- Agent TeamsがBedrock、Vertex、Foundryユーザーに対して誤ったモデル識別子を使用していた問題を修正
- ストリーミング中にMCPツールが画像コンテンツを返した際のクラッシュを修正
- `/resume`のセッションプレビューで、読みやすいコマンド名ではなく生のXMLタグが表示されていた問題を修正
- Bedrock/Vertex/Foundryユーザー向けのモデルエラーメッセージを改善し、フォールバック提案を追加
- プラグインブラウズで、既にインストール済みのプラグインに対して誤解を招く「スペースキーで切り替え」のヒントが表示されていた問題を修正
- フックブロッキングエラー（終了コード2）でstderrがユーザーに表示されなかった問題を修正
- 高速モードの可視性のため、OTelイベントとトレーススパンに`speed`属性を追加
- `claude auth login`、`claude auth status`、`claude auth logout`のCLIサブコマンドを追加
- Windows ARM64（win32-arm64）ネイティブバイナリサポートを追加
- `/rename`を改善し、引数なしで呼び出された場合に会話コンテキストからセッション名を自動生成するように変更
- プロンプトフッターの狭い端末レイアウトを改善
- アンカーフラグメント付きの@メンション（例：`@README.md#installation`）でファイル解決が失敗していた問題を修正
- FileReadToolがFIFO、`/dev/stdin`、大容量ファイルでプロセスをブロックしていた問題を修正
- ストリーミングAgent SDKモードでバックグラウンドタスク通知が配信されなかった問題を修正
- 分類ルール入力で各キーストロークごとにカーソルが末尾にジャンプしていた問題を修正
- Markdownリンクの表示テキストが生URLに対してドロップされていた問題を修正
- 自動コンパクト失敗エラー通知がユーザーに表示されていた問題を修正
- サブエージェントの経過時間表示にパーミッション待機時間が含まれていた問題を修正
- プランモード中にプロアクティブティックが発火していた問題を修正
- ディスク上の設定が変更された際に古いパーミッションルールがクリアされるように修正
- フックブロッキングエラーでstderrコンテンツがUIに表示されていた問題を修正

## 2.1.39

- ターミナルレンダリングのパフォーマンスを改善
- 致命的エラーが表示されずに飲み込まれていた問題を修正
- セッション終了後にプロセスがハングしていた問題を修正
- ターミナル画面境界での文字欠落を修正
- 詳細トランスクリプトビューでの空白行を修正

## 2.1.38

- 2.1.37で発生したVS Codeターミナルのスクロールトップへの移動の不具合を修正
- Tabキーがオートコンプリートではなくスラッシュコマンドをキューイングしていた問題を修正
- 環境変数ラッパーを使用するコマンドのbashパーミッションマッチングを修正
- ストリーミングを使用していない場合にツール使用間のテキストが消えていた問題を修正
- VS Code拡張機能で再開時に重複セッションが発生していた問題を修正
- heredocデリミタのパースを改善し、コマンドスマグリングを防止
- サンドボックスモードで`.claude/skills`ディレクトリへの書き込みをブロック

## 2.1.37

- `/extra-usage`を有効にした後、`/fast`がすぐに利用できなかった問題を修正

## 2.1.36

- Opus 4.6で高速モードが利用可能になりました。詳細は https://code.claude.com/docs/en/fast-mode をご覧ください

## 2.1.34

- レンダリング間でagent teams設定が変更された際のクラッシュを修正
- サンドボックスから除外されたコマンド（`sandbox.excludedCommands`または`dangerouslyDisableSandbox`経由）が、`autoAllowBashIfSandboxed`が有効な場合にBash askパーミッションルールをバイパスできていたバグを修正

## 2.1.33

- tmux内のエージェントチームメイトセッションでメッセージの送受信ができるように修正
- 現在のプランでagent teamsが利用できないことに関する警告を修正
- マルチエージェントワークフロー用の`TeammateIdle`および`TaskCompleted`フックイベントを追加
- エージェントの「tools」フロントマターで`Task(agent_type)`構文を使用して、生成可能なサブエージェントを制限するサポートを追加
- エージェント用の`memory`フロントマターフィールドサポートを追加し、`user`、`project`、または`local`スコープでの永続的メモリを有効化
- より良い発見性のため、スキルの説明と`/skills`メニューにプラグイン名を追加
- モデルが拡張思考中に新しいメッセージを送信すると思考フェーズが中断されていた問題を修正
- ストリーム中に中止した際、空白テキストと思考ブロックが組み合わさると正規化をバイパスして無効なリクエストを生成していたAPIエラーを修正
- ストリーミングエンドポイントでの404エラーが非ストリーミングフォールバックをトリガーしなくなったAPIプロキシ互換性の問題を修正
- `settings.json`環境変数で設定されたプロキシ設定が、Node.jsビルドのWebFetchやその他のHTTPリクエストに適用されなかった問題を修正
- `/resume`セッションピッカーで、スラッシュコマンドで開始されたセッションのクリーンなタイトルではなく生のXMLマークアップが表示されていた問題を修正
- API接続失敗のエラーメッセージを改善 — 一般的な「接続エラー」ではなく、特定の原因（例：ECONNREFUSED、SSLエラー）を表示
- 無効な管理設定からのエラーが表示されるように変更
- VSCode: リモートセッションのサポートを追加し、OAuthユーザーがclaude.aiからセッションを閲覧・再開できるように
- VSCode: セッションピッカーにgitブランチとメッセージ数を追加し、ブランチ名での検索をサポート
- VSCode: 初回セッション読み込みとセッション切り替え時のスクロール最下部への移動が不十分だった問題を修正

## 2.1.32

- Claude Opus 4.6が利用可能になりました！
- マルチエージェントコラボレーション用のリサーチプレビューagent teams機能を追加（トークン集約的な機能で、CLAUDE_CODE_EXPERIMENTAL_AGENT_TEAMS=1の設定が必要）
- Claudeが作業中に自動的にメモリを記録・想起するように
- メッセージセレクターに「ここから要約」を追加し、部分的な会話要約が可能に
- 追加ディレクトリ（`--add-dir`）内の`.claude/skills/`で定義されたスキルが自動的に読み込まれるように
- サブディレクトリから実行した際に`@`ファイル補完が誤った相対パスを表示していた問題を修正
- --resumeを更新し、前回の会話で指定された--agent値をデフォルトで再利用するように
- 修正：Bashツールがheredocに`${index + 1}`のようなJavaScriptテンプレートリテラルが含まれている場合に「Bad substitution」エラーをスローし、ツール実行を中断していた問題
- スキル文字予算がコンテキストウィンドウに応じてスケール（コンテキストの2%）するようになり、より大きなコンテキストウィンドウを持つユーザーが切り捨てなしでより多くのスキル説明を見られるように
- タイ語/ラオ語のスペーシング母音（สระ า、ำ）が入力フィールドで正しくレンダリングされなかった問題を修正
- VSCode: 入力フィールドに先行テキストがある状態でEnterキーを押した際にスラッシュコマンドが誤って実行されていた問題を修正
- VSCode: 過去の会話リスト読み込み時のスピナーを追加

## 2.1.31

- 終了時にセッション再開のヒントを追加し、後で会話を続ける方法を表示
- チェックボックス選択で日本語IMEからの全角スペース入力をサポート
- PDFが大きすぎるエラーでセッションが永久にロックされ、ユーザーが新しい会話を開始する必要があった問題を修正
- サンドボックスモードが有効な場合にbashコマンドが「読み取り専用ファイルシステム」エラーで誤って失敗を報告していた問題を修正
- `~/.claude.json`のプロジェクト設定にデフォルトフィールドが欠けている場合、プランモードに入った後にセッションが使用不能になるクラッシュを修正
- ストリーミングAPIパスで`temperatureOverride`が黙って無視され、設定された上書きに関係なくすべてのストリーミングリクエストがデフォルト温度（1）を使用していた問題を修正
- nullパラメータを拒否する厳格な言語サーバーとのLSPシャットダウン/終了の互換性を修正
- モデルが専用ツール（Read、Edit、Glob、Grep）をbash同等物（`cat`、`sed`、`grep`、`find`）の代わりに使用するようより明確に導くようシステムプロンプトを改善し、不要なbashコマンド使用を削減
- PDFとリクエストサイズのエラーメッセージを改善し、実際の制限（100ページ、20MB）を表示
- ストリーミング中にスピナーが表示・非表示になる際のターミナルでのレイアウトジッターを削減
- サードパーティプロバイダー（Bedrock、Vertex、Foundry）ユーザーに対して、モデルセレクターから誤解を招くAnthropic API価格を削除

## 2.1.30

- PDF用のReadツールに`pages`パラメータを追加し、特定のページ範囲を読み取れるように（例：`pages: "1-5"`）。大きなPDF（10ページ超）は、`@`メンションされた際にコンテキストにインライン化されるのではなく、軽量な参照を返すように
- Dynamic Client RegistrationをサポートしないMCPサーバー（例：Slack）用の事前設定されたOAuthクライアント認証情報を追加。`claude mcp add`で`--client-id`と`--client-secret`を使用
- 現在のセッションのトラブルシューティングをClaudeが支援する`/debug`を追加
- 読み取り専用モードで追加の`git log`および`git show`フラグをサポート（例：`--topo-order`、`--cherry-pick`、`--format`、`--raw`）
- Taskツール結果にトークン数、ツール使用回数、期間メトリクスを追加
- 設定にモーション軽減モードを追加
- API会話履歴に幽霊のような「(no content)」テキストブロックが表示され、トークンの無駄遣いとモデルの混乱を引き起こしていた問題を修正
- ツールの説明や入力スキーマが変更された際にプロンプトキャッシュが正しく無効化されず、ツール名が変更された場合のみ無効化されていた問題を修正
- 会話に思考ブロックが含まれている場合、`/login`実行後に400エラーが発生する可能性があった問題を修正
- `parentUuid`サイクルを含む破損したトランスクリプトファイルでセッションを再開した際のハングを修正
- Max 20xユーザーがextra-usageが利用できない場合に、レート制限メッセージで誤った「/upgrade」提案が表示されていた問題を修正
- アクティブに入力中にパーミッションダイアログがフォーカスを奪っていた問題を修正
- サブエージェントが共有アプリケーション状態に同期されていなかったため、SDK提供のMCPツールにアクセスできなかった問題を修正
- `.bashrc`ファイルを持つWindowsユーザーがbashコマンドを実行できなかった不具合を修正
- `--resume`のメモリ使用量を改善（多数のセッションを持つユーザーで68%削減）。セッションインデックスを軽量なstat基盤の読み込みと段階的エンリッチメントに置き換え
- `TaskStop`ツールを改善し、一般的な「タスク停止」メッセージではなく、停止されたコマンド/タスクの説明を結果行に表示
- `/model`を即座に実行するように変更（キューイングではなく）
- [VSCode] 質問ダイアログの「その他」テキスト入力に複数行入力サポートを追加（Shift+Enterで改行）
- [VSCode] 新しい会話を開始した際にセッションリストに重複セッションが表示されていた問題を修正

## 2.1.29

- `saved_hook_context`を持つセッションを再開する際の起動パフォーマンスの問題を修正

## 2.1.27

- デバッグログにツール呼び出しの失敗と拒否を追加
- ゲートウェイユーザーのコンテキスト管理検証エラーを修正し、`CLAUDE_CODE_DISABLE_EXPERIMENTAL_BETAS=1`でエラーを回避できるように
- 特定のGitHub PR番号またはURLにリンクされたセッションを再開する`--from-pr`フラグを追加
- `gh pr create`経由で作成された場合、セッションが自動的にPRにリンクされるように
- /contextコマンドが色付き出力を表示しなかった問題を修正
- PR状態が表示された際にステータスバーがバックグラウンドタスクインジケーターを重複表示していた問題を修正
- Windows: `.bashrc`ファイルを持つユーザーのbashコマンド実行が失敗していた問題を修正
- Windows: 子プロセスを生成する際にコンソールウィンドウがフラッシュしていた問題を修正
- VSCode: 長時間のセッション後にOAuthトークンの有効期限切れで401エラーが発生していた問題を修正

## 2.1.25

- BedrockとVertexのゲートウェイユーザーに対するベータヘッダー検証エラーを修正し、`CLAUDE_CODE_DISABLE_EXPERIMENTAL_BETAS=1`でエラーを回避できるように

## 2.1.23

- カスタマイズ可能なスピナー動詞設定（`spinnerVerbs`）を追加
- 企業プロキシの背後にいるユーザーやクライアント証明書を使用するユーザーのmTLSおよびプロキシ接続を修正
- 共有システムでのパーミッション競合を防ぐため、ユーザーごとの一時ディレクトリ分離を修正
- プロンプトキャッシングスコープが有効な場合に400エラーを引き起こす可能性があった競合状態を修正
- ヘッドレスストリーミングセッションが終了した際に、保留中の非同期フックがキャンセルされなかった問題を修正
- タブ補完が提案を受け入れた際に入力フィールドを更新しなかった問題を修正
- ripgrep検索タイムアウトがエラーを報告せずに空の結果を黙って返していた問題を修正
- 最適化された画面データレイアウトでターミナルレンダリングのパフォーマンスを改善
- Bashコマンドで経過時間と並んでタイムアウト期間を表示するように変更
- マージされたプルリクエストがプロンプトフッターで紫色のステータスインジケーターを表示するように変更
- [IDE] ヘッドレスモードのBedrockユーザーに対してモデルオプションが誤ったリージョン文字列を表示していた問題を修正

## 2.1.22

- 非対話型（-p）モードの構造化出力を修正

## 2.1.21

- オプション選択プロンプトで日本語IMEからの全角数字入力をサポート
- 終了時にシェル補完キャッシュファイルが切り捨てられていた問題を修正
- ツール実行中に中断されたセッションを再開する際のAPIエラーを修正
- 大きな出力トークン制限を持つモデルで自動コンパクトが早すぎるタイミングでトリガーされていた問題を修正
- 削除後にタスクIDが再利用される可能性があった問題を修正
- WindowsのVS Code拡張機能でファイル検索が機能しなかった問題を修正
- 読み取り/検索の進行状況インジケーターを改善し、進行中は「読み取り中…」、完了時は「読み取り完了」を表示
- Claudeがbash同等物（cat、sed、awk）よりもファイル操作ツール（Read、Edit、Write）を優先するように改善
- [VSCode] Pythonの仮想環境の自動アクティベーションを追加し、`python`および`pip`コマンドが正しいインタープリターを使用するように（`claudeCode.usePythonEnvironment`設定で設定可能）
- [VSCode] メッセージアクションボタンの背景色が誤っていた問題を修正

## 2.1.20

- カーソルがこれ以上移動できない場合のvimノーマルモードでの矢印キー履歴ナビゲーションを追加
- より良い発見性のため、外部エディターショートカット（Ctrl+G）をヘルプメニューに追加
- プロンプトフッターにPRレビューステータスインジケーターを追加し、現在のブランチのPR状態（承認済み、変更要求、保留中、またはドラフト）をクリック可能なリンク付きの色付きドットで表示
- `--add-dir`フラグで指定された追加ディレクトリからの`CLAUDE.md`ファイルの読み込みをサポート（`CLAUDE_CODE_ADDITIONAL_DIRECTORIES_CLAUDE_MD=1`の設定が必要）
- `TaskUpdate`ツール経由でタスクを削除する機能を追加
- 再開時に完全な履歴がコンパクトサマリーではなく読み込まれる可能性があったセッションコンパクションの問題を修正
- タスクに積極的に取り組んでいる間に送信されたユーザーメッセージをエージェントが無視することがあった問題を修正
- より狭い文字に置き換えられた際に末尾の列がクリアされなかった全角文字（絵文字、CJK）のレンダリングアーティファクトを修正
- MCPツールレスポンスに特殊なUnicode文字が含まれている場合のJSON解析エラーを修正
- 複数行および折り返しテキスト入力での上下矢印キーが履歴ナビゲーションよりもカーソル移動を優先するように修正
- コマンド履歴をナビゲートするためにUP矢印キーを押した際にドラフトプロンプトが失われていた問題を修正
- 入力途中でスラッシュコマンドを入力した際のゴーストテキストのちらつきを修正
- マーケットプレイスソース削除が設定を適切に削除しなかった問題を修正
- `/context`のようなコマンドでの重複出力を修正
- タスクリストがメイン会話ビューの外に表示されることがあった問題を修正
- Pythonのdocstringのような複数行構造内で発生する差分の構文ハイライトを修正
- ツール使用をキャンセルした際のクラッシュを修正
- `/sandbox`コマンドUIを改善し、依存関係が欠けている場合にインストール手順付きで依存関係ステータスを表示
- 思考ステータステキストに微妙なシマーアニメーションを追加して改善
- ターミナルの高さに基づいて表示アイテムを動的に調整するようタスクリストを改善
- 元のセッションを再開する方法を示すようフォーク会話ヒントを改善
- 折りたたまれた読み取り/検索グループが進行中は現在形（「読み取り中」、「検索中」）、完了時は過去形（「読み取り完了」、「検索完了」）を表示するように変更
- `ToolSearch`結果が会話内のインラインではなく簡単な通知として表示されるように変更
- `/commit-push-pr`スキルが、MCPツール経由で設定された場合にPR URLを自動的にSlackチャンネルに投稿するように変更
- `/copy`コマンドをすべてのユーザーが利用できるように変更
- バックグラウンドエージェントが起動前にツールパーミッションを求めるように変更
- `Bash(*)`のようなパーミッションルールが受け入れられ、`Bash`と同等として扱われるように変更
- データ損失を防ぐため、設定バックアップがタイムスタンプ付きでローテーション（最新5つを保持）されるように変更

## 2.1.19

- 環境変数`CLAUDE_CODE_ENABLE_TASKS`を追加、`false`に設定すると一時的に古いシステムを維持
- カスタムコマンドで個別の引数にアクセスするための短縮形`$0`、`$1`などを追加
- AVX命令サポートのないプロセッサでのクラッシュを修正
- `process.exit()`からのEIOエラーをキャッチし、フォールバックとしてSIGKILLを使用することで、ターミナルが閉じられた際のClaude Codeプロセスの残存を修正
- 異なるディレクトリ（例：gitワークツリー）から再開した際に`/rename`と`/tag`が正しいセッションを更新しなかった問題を修正
- 異なるディレクトリから実行した際にカスタムタイトルでセッションを再開できなかった問題を修正
- プロンプトスタッシュ（Ctrl+S）と復元を使用した際に貼り付けられたテキストコンテンツが失われていた問題を修正
- 明示的なモデル設定のないエージェントに対して、エージェントリストが「Sonnet（デフォルト）」ではなく「継承（デフォルト）」を表示するように修正
- バックグラウンド化されたフックコマンドが早期に戻らず、意図的にバックグラウンド化されたプロセスをセッションが待機する可能性があった問題を修正
- ファイル書き込みプレビューで空行が省略されていた問題を修正
- 追加のパーミッションやフックのないスキルが承認を必要とせずに許可されるように変更
- インデックス付き引数構文を`$ARGUMENTS.0`から`$ARGUMENTS[0]`（ブラケット構文）に変更
- [SDK] `replayUserMessages`が有効な場合、`queued_command`添付メッセージを`SDKUserMessageReplay`イベントとしてリプレイする機能を追加
- [VSCode] すべてのユーザーに対してセッションフォークおよび巻き戻し機能を有効化

## 2.1.18

- カスタマイズ可能なキーボードショートカットを追加。コンテキストごとにキーバインドを設定し、コードシーケンスを作成し、ワークフローをパーソナライズできます。`/keybindings`を実行して開始してください。詳細は https://code.claude.com/docs/en/keybindings をご覧ください

## 2.1.17

---

*最新20バージョンのみ表示*